"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/crowd-density/route";
exports.ids = ["app/api/crowd-density/route"];
exports.modules = {

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "buffer":
/*!*************************!*\
  !*** external "buffer" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("buffer");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("crypto");

/***/ }),

/***/ "events":
/*!*************************!*\
  !*** external "events" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("events");

/***/ }),

/***/ "http":
/*!***********************!*\
  !*** external "http" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("http");

/***/ }),

/***/ "https":
/*!************************!*\
  !*** external "https" ***!
  \************************/
/***/ ((module) => {

module.exports = require("https");

/***/ }),

/***/ "net":
/*!**********************!*\
  !*** external "net" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("net");

/***/ }),

/***/ "punycode":
/*!***************************!*\
  !*** external "punycode" ***!
  \***************************/
/***/ ((module) => {

module.exports = require("punycode");

/***/ }),

/***/ "stream":
/*!*************************!*\
  !*** external "stream" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("stream");

/***/ }),

/***/ "tls":
/*!**********************!*\
  !*** external "tls" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("tls");

/***/ }),

/***/ "url":
/*!**********************!*\
  !*** external "url" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("url");

/***/ }),

/***/ "zlib":
/*!***********************!*\
  !*** external "zlib" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("zlib");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fcrowd-density%2Froute&page=%2Fapi%2Fcrowd-density%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fcrowd-density%2Froute.ts&appDir=C%3A%5CUsers%5Cyouse%5COneDrive%5CDesktop%5CKAU%5CFourth_Year_IT%5CTerm2%5CCPIT-455%5CFinal-Project%5Ctafweej_Hajj%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5Cyouse%5COneDrive%5CDesktop%5CKAU%5CFourth_Year_IT%5CTerm2%5CCPIT-455%5CFinal-Project%5Ctafweej_Hajj&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!*************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fcrowd-density%2Froute&page=%2Fapi%2Fcrowd-density%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fcrowd-density%2Froute.ts&appDir=C%3A%5CUsers%5Cyouse%5COneDrive%5CDesktop%5CKAU%5CFourth_Year_IT%5CTerm2%5CCPIT-455%5CFinal-Project%5Ctafweej_Hajj%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5Cyouse%5COneDrive%5CDesktop%5CKAU%5CFourth_Year_IT%5CTerm2%5CCPIT-455%5CFinal-Project%5Ctafweej_Hajj&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \*************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var C_Users_youse_OneDrive_Desktop_KAU_Fourth_Year_IT_Term2_CPIT_455_Final_Project_tafweej_Hajj_src_app_api_crowd_density_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./src/app/api/crowd-density/route.ts */ \"(rsc)/./src/app/api/crowd-density/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/crowd-density/route\",\n        pathname: \"/api/crowd-density\",\n        filename: \"route\",\n        bundlePath: \"app/api/crowd-density/route\"\n    },\n    resolvedPagePath: \"C:\\\\Users\\\\youse\\\\OneDrive\\\\Desktop\\\\KAU\\\\Fourth_Year_IT\\\\Term2\\\\CPIT-455\\\\Final-Project\\\\tafweej_Hajj\\\\src\\\\app\\\\api\\\\crowd-density\\\\route.ts\",\n    nextConfigOutput,\n    userland: C_Users_youse_OneDrive_Desktop_KAU_Fourth_Year_IT_Term2_CPIT_455_Final_Project_tafweej_Hajj_src_app_api_crowd_density_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/crowd-density/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZjcm93ZC1kZW5zaXR5JTJGcm91dGUmcGFnZT0lMkZhcGklMkZjcm93ZC1kZW5zaXR5JTJGcm91dGUmYXBwUGF0aHM9JnBhZ2VQYXRoPXByaXZhdGUtbmV4dC1hcHAtZGlyJTJGYXBpJTJGY3Jvd2QtZGVuc2l0eSUyRnJvdXRlLnRzJmFwcERpcj1DJTNBJTVDVXNlcnMlNUN5b3VzZSU1Q09uZURyaXZlJTVDRGVza3RvcCU1Q0tBVSU1Q0ZvdXJ0aF9ZZWFyX0lUJTVDVGVybTIlNUNDUElULTQ1NSU1Q0ZpbmFsLVByb2plY3QlNUN0YWZ3ZWVqX0hhamolNUNzcmMlNUNhcHAmcGFnZUV4dGVuc2lvbnM9dHN4JnBhZ2VFeHRlbnNpb25zPXRzJnBhZ2VFeHRlbnNpb25zPWpzeCZwYWdlRXh0ZW5zaW9ucz1qcyZyb290RGlyPUMlM0ElNUNVc2VycyU1Q3lvdXNlJTVDT25lRHJpdmUlNUNEZXNrdG9wJTVDS0FVJTVDRm91cnRoX1llYXJfSVQlNUNUZXJtMiU1Q0NQSVQtNDU1JTVDRmluYWwtUHJvamVjdCU1Q3RhZndlZWpfSGFqaiZpc0Rldj10cnVlJnRzY29uZmlnUGF0aD10c2NvbmZpZy5qc29uJmJhc2VQYXRoPSZhc3NldFByZWZpeD0mbmV4dENvbmZpZ091dHB1dD0mcHJlZmVycmVkUmVnaW9uPSZtaWRkbGV3YXJlQ29uZmlnPWUzMCUzRCEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7O0FBQXNHO0FBQ3ZDO0FBQ2M7QUFDOEY7QUFDM0s7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLGdIQUFtQjtBQUMzQztBQUNBLGNBQWMseUVBQVM7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLFlBQVk7QUFDWixDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0EsUUFBUSxpRUFBaUU7QUFDekU7QUFDQTtBQUNBLFdBQVcsNEVBQVc7QUFDdEI7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUN1SDs7QUFFdkgiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9oYWpqLW5hdmlnYXRvci8/ZjEwYyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBBcHBSb3V0ZVJvdXRlTW9kdWxlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLW1vZHVsZXMvYXBwLXJvdXRlL21vZHVsZS5jb21waWxlZFwiO1xuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLWtpbmRcIjtcbmltcG9ydCB7IHBhdGNoRmV0Y2ggYXMgX3BhdGNoRmV0Y2ggfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9saWIvcGF0Y2gtZmV0Y2hcIjtcbmltcG9ydCAqIGFzIHVzZXJsYW5kIGZyb20gXCJDOlxcXFxVc2Vyc1xcXFx5b3VzZVxcXFxPbmVEcml2ZVxcXFxEZXNrdG9wXFxcXEtBVVxcXFxGb3VydGhfWWVhcl9JVFxcXFxUZXJtMlxcXFxDUElULTQ1NVxcXFxGaW5hbC1Qcm9qZWN0XFxcXHRhZndlZWpfSGFqalxcXFxzcmNcXFxcYXBwXFxcXGFwaVxcXFxjcm93ZC1kZW5zaXR5XFxcXHJvdXRlLnRzXCI7XG4vLyBXZSBpbmplY3QgdGhlIG5leHRDb25maWdPdXRwdXQgaGVyZSBzbyB0aGF0IHdlIGNhbiB1c2UgdGhlbSBpbiB0aGUgcm91dGVcbi8vIG1vZHVsZS5cbmNvbnN0IG5leHRDb25maWdPdXRwdXQgPSBcIlwiXG5jb25zdCByb3V0ZU1vZHVsZSA9IG5ldyBBcHBSb3V0ZVJvdXRlTW9kdWxlKHtcbiAgICBkZWZpbml0aW9uOiB7XG4gICAgICAgIGtpbmQ6IFJvdXRlS2luZC5BUFBfUk9VVEUsXG4gICAgICAgIHBhZ2U6IFwiL2FwaS9jcm93ZC1kZW5zaXR5L3JvdXRlXCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvY3Jvd2QtZGVuc2l0eVwiLFxuICAgICAgICBmaWxlbmFtZTogXCJyb3V0ZVwiLFxuICAgICAgICBidW5kbGVQYXRoOiBcImFwcC9hcGkvY3Jvd2QtZGVuc2l0eS9yb3V0ZVwiXG4gICAgfSxcbiAgICByZXNvbHZlZFBhZ2VQYXRoOiBcIkM6XFxcXFVzZXJzXFxcXHlvdXNlXFxcXE9uZURyaXZlXFxcXERlc2t0b3BcXFxcS0FVXFxcXEZvdXJ0aF9ZZWFyX0lUXFxcXFRlcm0yXFxcXENQSVQtNDU1XFxcXEZpbmFsLVByb2plY3RcXFxcdGFmd2Vlal9IYWpqXFxcXHNyY1xcXFxhcHBcXFxcYXBpXFxcXGNyb3dkLWRlbnNpdHlcXFxccm91dGUudHNcIixcbiAgICBuZXh0Q29uZmlnT3V0cHV0LFxuICAgIHVzZXJsYW5kXG59KTtcbi8vIFB1bGwgb3V0IHRoZSBleHBvcnRzIHRoYXQgd2UgbmVlZCB0byBleHBvc2UgZnJvbSB0aGUgbW9kdWxlLiBUaGlzIHNob3VsZFxuLy8gYmUgZWxpbWluYXRlZCB3aGVuIHdlJ3ZlIG1vdmVkIHRoZSBvdGhlciByb3V0ZXMgdG8gdGhlIG5ldyBmb3JtYXQuIFRoZXNlXG4vLyBhcmUgdXNlZCB0byBob29rIGludG8gdGhlIHJvdXRlLlxuY29uc3QgeyByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcyB9ID0gcm91dGVNb2R1bGU7XG5jb25zdCBvcmlnaW5hbFBhdGhuYW1lID0gXCIvYXBpL2Nyb3dkLWRlbnNpdHkvcm91dGVcIjtcbmZ1bmN0aW9uIHBhdGNoRmV0Y2goKSB7XG4gICAgcmV0dXJuIF9wYXRjaEZldGNoKHtcbiAgICAgICAgc2VydmVySG9va3MsXG4gICAgICAgIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2VcbiAgICB9KTtcbn1cbmV4cG9ydCB7IHJvdXRlTW9kdWxlLCByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcywgb3JpZ2luYWxQYXRobmFtZSwgcGF0Y2hGZXRjaCwgIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFwcC1yb3V0ZS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fcrowd-density%2Froute&page=%2Fapi%2Fcrowd-density%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fcrowd-density%2Froute.ts&appDir=C%3A%5CUsers%5Cyouse%5COneDrive%5CDesktop%5CKAU%5CFourth_Year_IT%5CTerm2%5CCPIT-455%5CFinal-Project%5Ctafweej_Hajj%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5Cyouse%5COneDrive%5CDesktop%5CKAU%5CFourth_Year_IT%5CTerm2%5CCPIT-455%5CFinal-Project%5Ctafweej_Hajj&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./src/app/api/crowd-density/route.ts":
/*!********************************************!*\
  !*** ./src/app/api/crowd-density/route.ts ***!
  \********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GET: () => (/* binding */ GET),\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var _lib_supabase__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/supabase */ \"(rsc)/./src/lib/supabase.ts\");\n/* harmony import */ var _lib_crowdSensors__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/crowdSensors */ \"(rsc)/./src/lib/crowdSensors.ts\");\n\n\n\n// GET handler to fetch crowd density data\nasync function GET(request) {\n    try {\n        // Log environment variables (masked for security)\n        console.log(\"Supabase URL available:\", !!\"https://uowkmsvtqrsyblobsazw.supabase.co/\");\n        console.log(\"Supabase Anon Key available:\", !!\"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InVvd2ttc3Z0cXJzeWJsb2JzYXp3Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDU0Mzc2NTgsImV4cCI6MjA2MTAxMzY1OH0.EBQ3Pn9yvN2L6G5HTe5c10bGOF8xs28jQ-plE1g8HOc\");\n        console.log(\"Supabase Service Role Key available:\", !!process.env.SUPABASE_SERVICE_ROLE_KEY);\n        console.log(\"supabaseAdmin client available:\", !!_lib_supabase__WEBPACK_IMPORTED_MODULE_1__.supabaseAdmin);\n        // Extract the force parameter from the URL\n        const { searchParams } = new URL(request.url);\n        const forceRefresh = searchParams.get(\"force\") === \"true\";\n        // If supabaseAdmin is not available, skip database and use direct calculation\n        if (!_lib_supabase__WEBPACK_IMPORTED_MODULE_1__.supabaseAdmin) {\n            console.log(\"No supabaseAdmin client, using direct calculation\");\n            const calculatedData = await (0,_lib_crowdSensors__WEBPACK_IMPORTED_MODULE_2__.calculateRealisticCrowdDensities)();\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json(calculatedData);\n        }\n        try {\n            // If force refresh is requested, generate new data\n            if (forceRefresh) {\n                console.log(\"Force refresh requested, generating new crowd density data\");\n                const result = await (0,_lib_crowdSensors__WEBPACK_IMPORTED_MODULE_2__.updateCrowdDensityData)();\n                // If we got data directly from updateCrowdDensityData, use it\n                if (result.data) {\n                    console.log(\"Using data returned directly from updateCrowdDensityData\");\n                    return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json(result.data);\n                }\n                if (\"error\" in result) {\n                    console.error(\"Error in updateCrowdDensityData during force refresh:\", result.error);\n                    // Use direct calculation instead\n                    const calculatedData = await (0,_lib_crowdSensors__WEBPACK_IMPORTED_MODULE_2__.calculateRealisticCrowdDensities)();\n                    return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json(calculatedData);\n                }\n                console.log(\"Fetching fresh data after forced update\");\n                try {\n                    const { data: freshData, error: fetchError } = await _lib_supabase__WEBPACK_IMPORTED_MODULE_1__.supabaseAdmin.from(\"crowd_density\").select(\"*\").order(\"updated_at\", {\n                        ascending: false\n                    });\n                    if (fetchError) {\n                        throw fetchError;\n                    }\n                    return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json(freshData);\n                } catch (dbErr) {\n                    console.error(\"DB error after force refresh, using direct calculation:\", dbErr);\n                    const calculatedData = await (0,_lib_crowdSensors__WEBPACK_IMPORTED_MODULE_2__.calculateRealisticCrowdDensities)();\n                    return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json(calculatedData);\n                }\n            }\n            // First check if data exists in database\n            try {\n                const { data, error } = await _lib_supabase__WEBPACK_IMPORTED_MODULE_1__.supabaseAdmin.from(\"crowd_density\").select(\"*\").order(\"updated_at\", {\n                    ascending: false\n                });\n                if (error) {\n                    throw error;\n                }\n                // If we have data and it was updated in the last 5 minutes, use it\n                const fiveMinutesAgo = new Date(Date.now() - 5 * 60 * 1000).toISOString();\n                const hasRecentData = data && data.length > 0 && data[0].updated_at > fiveMinutesAgo;\n                if (hasRecentData) {\n                    console.log(\"Using recent data from database\");\n                    return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json(data);\n                }\n            } catch (dbErr) {\n                console.error(\"Error querying database:\", dbErr);\n            // Continue to calculating new data\n            }\n            // Otherwise, generate new data\n            console.log(\"Generating new crowd density data\");\n            try {\n                const result = await (0,_lib_crowdSensors__WEBPACK_IMPORTED_MODULE_2__.updateCrowdDensityData)();\n                // If we got data directly from updateCrowdDensityData, use it\n                if (result.data) {\n                    console.log(\"Using data returned directly from updateCrowdDensityData\");\n                    return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json(result.data);\n                }\n                if (\"error\" in result) {\n                    throw new Error(`Failed to update crowd density data: ${result.error}`);\n                }\n                // Fetch the newly inserted data\n                const { data: freshData, error: fetchError } = await _lib_supabase__WEBPACK_IMPORTED_MODULE_1__.supabaseAdmin.from(\"crowd_density\").select(\"*\").order(\"updated_at\", {\n                    ascending: false\n                });\n                if (fetchError) {\n                    throw fetchError;\n                }\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json(freshData);\n            } catch (updateErr) {\n                console.error(\"Error during data update:\", updateErr);\n                // Use direct calculation as fallback\n                const calculatedData = await (0,_lib_crowdSensors__WEBPACK_IMPORTED_MODULE_2__.calculateRealisticCrowdDensities)();\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json(calculatedData);\n            }\n        } catch (supabaseErr) {\n            console.error(\"Supabase operation error:\", supabaseErr);\n            // If database operations fail, return calculated data directly\n            const calculatedData = await (0,_lib_crowdSensors__WEBPACK_IMPORTED_MODULE_2__.calculateRealisticCrowdDensities)();\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json(calculatedData);\n        }\n    } catch (mainError) {\n        console.error(\"Main error handler caught:\", mainError);\n        // Final fallback - always return calculated data if all else fails\n        try {\n            const calculatedData = await (0,_lib_crowdSensors__WEBPACK_IMPORTED_MODULE_2__.calculateRealisticCrowdDensities)();\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json(calculatedData);\n        } catch (calcError) {\n            console.error(\"Even calculation failed:\", calcError);\n            // Return empty array instead of an error to ensure JSON is returned\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json([]);\n        }\n    }\n}\n// POST handler to update crowd density data\nasync function POST(request) {\n    try {\n        console.log(\"POST request to crowd-density API\");\n        // If supabaseAdmin is not available, just recalculate directly\n        if (!_lib_supabase__WEBPACK_IMPORTED_MODULE_1__.supabaseAdmin) {\n            console.log(\"No supabaseAdmin client, calculating directly\");\n            try {\n                // Get request body\n                const body = await request.json();\n                // Check if it's a recalculation request\n                if (body.recalculate === true) {\n                    const result = await (0,_lib_crowdSensors__WEBPACK_IMPORTED_MODULE_2__.updateCrowdDensityData)();\n                    // Use data from the result if available\n                    return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                        success: true,\n                        message: result.message || \"Crowd density data recalculated directly (no DB)\",\n                        count: result.count || 0\n                    });\n                }\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    success: false,\n                    message: \"Manual entry not supported without database\"\n                }, {\n                    status: 400\n                });\n            } catch (err) {\n                console.error(\"Error parsing request or calculating density:\", err);\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    success: false,\n                    message: \"Error processing request\"\n                }, {\n                    status: 400\n                });\n            }\n        }\n        try {\n            // Get request body\n            const body = await request.json();\n            // Check if it's a recalculation request\n            if (body.recalculate === true) {\n                console.log(\"Recalculation request received\");\n                try {\n                    const result = await (0,_lib_crowdSensors__WEBPACK_IMPORTED_MODULE_2__.updateCrowdDensityData)();\n                    // If we have data directly in the result, report success\n                    if (result.data) {\n                        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                            success: true,\n                            message: result.message || \"Crowd density data recalculated\",\n                            count: result.count || result.data.length\n                        });\n                    }\n                    if (\"error\" in result) {\n                        throw new Error(`Failed to recalculate: ${result.error}`);\n                    }\n                    console.log(\"Recalculation successful:\", result);\n                    return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                        success: true,\n                        message: \"Crowd density data recalculated\",\n                        count: result.count || 0\n                    });\n                } catch (recalcErr) {\n                    console.error(\"Recalculation error:\", recalcErr);\n                    // Return success with direct calculation\n                    const calculatedData = await (0,_lib_crowdSensors__WEBPACK_IMPORTED_MODULE_2__.calculateRealisticCrowdDensities)();\n                    return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                        success: true,\n                        message: \"Used direct calculation (DB update failed)\",\n                        count: calculatedData.length\n                    });\n                }\n            }\n            // Otherwise handle manual entry\n            console.log(\"Manual entry request received\");\n            // Validate request body\n            if (!body.location_name || !body.coordinates || !body.density_level) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Missing required fields\"\n                }, {\n                    status: 400\n                });\n            }\n            // Update or insert crowd density data\n            try {\n                const { data, error } = await _lib_supabase__WEBPACK_IMPORTED_MODULE_1__.supabaseAdmin.from(\"crowd_density\").upsert({\n                    location_name: body.location_name,\n                    coordinates: body.coordinates,\n                    density_level: body.density_level,\n                    updated_at: new Date().toISOString(),\n                    crowd_size: body.crowd_size || null,\n                    occupancy_percentage: body.occupancy_percentage || null,\n                    meta_data: body.meta_data || null\n                }).select();\n                if (error) {\n                    throw error;\n                }\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json(data);\n            } catch (upsertErr) {\n                console.error(\"Error during upsert operation:\", upsertErr);\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: \"Database update failed, but request was valid\"\n                }, {\n                    status: 500\n                });\n            }\n        } catch (bodyErr) {\n            console.error(\"Error parsing request body:\", bodyErr);\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Invalid request format\"\n            }, {\n                status: 400\n            });\n        }\n    } catch (mainErr) {\n        console.error(\"Unhandled error in POST handler:\", mainErr);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: \"Server error processing request\"\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvYXBwL2FwaS9jcm93ZC1kZW5zaXR5L3JvdXRlLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7O0FBQTJDO0FBQ0k7QUFDK0M7QUFFOUYsMENBQTBDO0FBQ25DLGVBQWVJLElBQUlDLE9BQWdCO0lBQ3hDLElBQUk7UUFDRixrREFBa0Q7UUFDbERDLFFBQVFDLEdBQUcsQ0FBQywyQkFBMkIsQ0FBQyxDQUFDQywyQ0FBb0M7UUFDN0VGLFFBQVFDLEdBQUcsQ0FBQyxnQ0FBZ0MsQ0FBQyxDQUFDQyxrTkFBeUM7UUFDdkZGLFFBQVFDLEdBQUcsQ0FBQyx3Q0FBd0MsQ0FBQyxDQUFDQyxRQUFRQyxHQUFHLENBQUNHLHlCQUF5QjtRQUMzRk4sUUFBUUMsR0FBRyxDQUFDLG1DQUFtQyxDQUFDLENBQUNOLHdEQUFhQTtRQUU5RCwyQ0FBMkM7UUFDM0MsTUFBTSxFQUFFWSxZQUFZLEVBQUUsR0FBRyxJQUFJQyxJQUFJVCxRQUFRVSxHQUFHO1FBQzVDLE1BQU1DLGVBQWVILGFBQWFJLEdBQUcsQ0FBQyxhQUFhO1FBRW5ELDhFQUE4RTtRQUM5RSxJQUFJLENBQUNoQix3REFBYUEsRUFBRTtZQUNsQkssUUFBUUMsR0FBRyxDQUFDO1lBQ1osTUFBTVcsaUJBQWlCLE1BQU1mLG1GQUFnQ0E7WUFDN0QsT0FBT0gscURBQVlBLENBQUNtQixJQUFJLENBQUNEO1FBQzNCO1FBRUEsSUFBSTtZQUNGLG1EQUFtRDtZQUNuRCxJQUFJRixjQUFjO2dCQUNoQlYsUUFBUUMsR0FBRyxDQUFDO2dCQUNaLE1BQU1hLFNBQVMsTUFBTWxCLHlFQUFzQkE7Z0JBRTNDLDhEQUE4RDtnQkFDOUQsSUFBSWtCLE9BQU9DLElBQUksRUFBRTtvQkFDZmYsUUFBUUMsR0FBRyxDQUFDO29CQUNaLE9BQU9QLHFEQUFZQSxDQUFDbUIsSUFBSSxDQUFDQyxPQUFPQyxJQUFJO2dCQUN0QztnQkFFQSxJQUFJLFdBQVdELFFBQVE7b0JBQ3JCZCxRQUFRZ0IsS0FBSyxDQUFDLHlEQUF5REYsT0FBT0UsS0FB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LFNBQVM7UUFDaEJ0RCxRQUFRZ0IsS0FBSyxDQUFDLG9DQUFvQ3NDO1FBQ2xELE9BQU81RCxxREFBWUEsQ0FBQ21CLElBQUksQ0FDdEI7WUFBRUcsT0FBTztRQUFrQyxHQUMzQztZQUFFMEIsUUFBUTtRQUFJO0lBRWxCO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9oYWpqLW5hdmlnYXRvci8uL3NyYy9hcHAvYXBpL2Nyb3dkLWRlbnNpdHkvcm91dGUudHM/MWQwYyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBOZXh0UmVzcG9uc2UgfSBmcm9tICduZXh0L3NlcnZlcic7XHJcbmltcG9ydCB7IHN1cGFiYXNlQWRtaW4gfSBmcm9tICdAL2xpYi9zdXBhYmFzZSc7XHJcbmltcG9ydCB7IHVwZGF0ZUNyb3dkRGVuc2l0eURhdGEsIGNhbGN1bGF0ZVJlYWxpc3RpY0Nyb3dkRGVuc2l0aWVzIH0gZnJvbSAnQC9saWIvY3Jvd2RTZW5zb3JzJztcclxuXHJcbi8vIEdFVCBoYW5kbGVyIHRvIGZldGNoIGNyb3dkIGRlbnNpdHkgZGF0YVxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gR0VUKHJlcXVlc3Q6IFJlcXVlc3QpIHtcclxuICB0cnkge1xyXG4gICAgLy8gTG9nIGVudmlyb25tZW50IHZhcmlhYmxlcyAobWFza2VkIGZvciBzZWN1cml0eSlcclxuICAgIGNvbnNvbGUubG9nKCdTdXBhYmFzZSBVUkwgYXZhaWxhYmxlOicsICEhcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfU1VQQUJBU0VfVVJMKTtcclxuICAgIGNvbnNvbGUubG9nKCdTdXBhYmFzZSBBbm9uIEtleSBhdmFpbGFibGU6JywgISFwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19TVVBBQkFTRV9BTk9OX0tFWSk7XHJcbiAgICBjb25zb2xlLmxvZygnU3VwYWJhc2UgU2VydmljZSBSb2xlIEtleSBhdmFpbGFibGU6JywgISFwcm9jZXNzLmVudi5TVVBBQkFTRV9TRVJWSUNFX1JPTEVfS0VZKTtcclxuICAgIGNvbnNvbGUubG9nKCdzdXBhYmFzZUFkbWluIGNsaWVudCBhdmFpbGFibGU6JywgISFzdXBhYmFzZUFkbWluKTtcclxuXHJcbiAgICAvLyBFeHRyYWN0IHRoZSBmb3JjZSBwYXJhbWV0ZXIgZnJvbSB0aGUgVVJMXHJcbiAgICBjb25zdCB7IHNlYXJjaFBhcmFtcyB9ID0gbmV3IFVSTChyZXF1ZXN0LnVybCk7XHJcbiAgICBjb25zdCBmb3JjZVJlZnJlc2ggPSBzZWFyY2hQYXJhbXMuZ2V0KCdmb3JjZScpID09PSAndHJ1ZSc7XHJcblxyXG4gICAgLy8gSWYgc3VwYWJhc2VBZG1pbiBpcyBub3QgYXZhaWxhYmxlLCBza2lwIGRhdGFiYXNlIGFuZCB1c2UgZGlyZWN0IGNhbGN1bGF0aW9uXHJcbiAgICBpZiAoIXN1cGFiYXNlQWRtaW4pIHtcclxuICAgICAgY29uc29sZS5sb2coJ05vIHN1cGFiYXNlQWRtaW4gY2xpZW50LCB1c2luZyBkaXJlY3QgY2FsY3VsYXRpb24nKTtcclxuICAgICAgY29uc3QgY2FsY3VsYXRlZERhdGEgPSBhd2FpdCBjYWxjdWxhdGVSZWFsaXN0aWNDcm93ZERlbnNpdGllcygpO1xyXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oY2FsY3VsYXRlZERhdGEpO1xyXG4gICAgfVxyXG5cclxuICAgIHRyeSB7XHJcbiAgICAgIC8vIElmIGZvcmNlIHJlZnJlc2ggaXMgcmVxdWVzdGVkLCBnZW5lcmF0ZSBuZXcgZGF0YVxyXG4gICAgICBpZiAoZm9yY2VSZWZyZXNoKSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coJ0ZvcmNlIHJlZnJlc2ggcmVxdWVzdGVkLCBnZW5lcmF0aW5nIG5ldyBjcm93ZCBkZW5zaXR5IGRhdGEnKTtcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB1cGRhdGVDcm93ZERlbnNpdHlEYXRhKCk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gSWYgd2UgZ290IGRhdGEgZGlyZWN0bHkgZnJvbSB1cGRhdGVDcm93ZERlbnNpdHlEYXRhLCB1c2UgaXRcclxuICAgICAgICBpZiAocmVzdWx0LmRhdGEpIHtcclxuICAgICAgICAgIGNvbnNvbGUubG9nKCdVc2luZyBkYXRhIHJldHVybmVkIGRpcmVjdGx5IGZyb20gdXBkYXRlQ3Jvd2REZW5zaXR5RGF0YScpO1xyXG4gICAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHJlc3VsdC5kYXRhKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgaWYgKCdlcnJvcicgaW4gcmVzdWx0KSB7XHJcbiAgICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBpbiB1cGRhdGVDcm93ZERlbnNpdHlEYXRhIGR1cmluZyBmb3JjZSByZWZyZXNoOicsIHJlc3VsdC5lcnJvcik7XHJcbiAgICAgICAgICAvLyBVc2UgZGlyZWN0IGNhbGN1bGF0aW9uIGluc3RlYWRcclxuICAgICAgICAgIGNvbnN0IGNhbGN1bGF0ZWREYXRhID0gYXdhaXQgY2FsY3VsYXRlUmVhbGlzdGljQ3Jvd2REZW5zaXRpZXMoKTtcclxuICAgICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihjYWxjdWxhdGVkRGF0YSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIGNvbnNvbGUubG9nKCdGZXRjaGluZyBmcmVzaCBkYXRhIGFmdGVyIGZvcmNlZCB1cGRhdGUnKTtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgY29uc3QgeyBkYXRhOiBmcmVzaERhdGEsIGVycm9yOiBmZXRjaEVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZUFkbWluXHJcbiAgICAgICAgICAgIC5mcm9tKCdjcm93ZF9kZW5zaXR5JylcclxuICAgICAgICAgICAgLnNlbGVjdCgnKicpXHJcbiAgICAgICAgICAgIC5vcmRlcigndXBkYXRlZF9hdCcsIHsgYXNjZW5kaW5nOiBmYWxzZSB9KTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICBpZiAoZmV0Y2hFcnJvcikge1xyXG4gICAgICAgICAgICB0aHJvdyBmZXRjaEVycm9yO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgXHJcbiAgICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oZnJlc2hEYXRhKTtcclxuICAgICAgICB9IGNhdGNoIChkYkVycikge1xyXG4gICAgICAgICAgY29uc29sZS5lcnJvcignREIgZXJyb3IgYWZ0ZXIgZm9yY2UgcmVmcmVzaCwgdXNpbmcgZGlyZWN0IGNhbGN1bGF0aW9uOicsIGRiRXJyKTtcclxuICAgICAgICAgIGNvbnN0IGNhbGN1bGF0ZWREYXRhID0gYXdhaXQgY2FsY3VsYXRlUmVhbGlzdGljQ3Jvd2REZW5zaXRpZXMoKTtcclxuICAgICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihjYWxjdWxhdGVkRGF0YSk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcblxyXG4gICAgICAvLyBGaXJzdCBjaGVjayBpZiBkYXRhIGV4aXN0cyBpbiBkYXRhYmFzZVxyXG4gICAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlQWRtaW5cclxuICAgICAgICAgIC5mcm9tKCdjcm93ZF9kZW5zaXR5JylcclxuICAgICAgICAgIC5zZWxlY3QoJyonKVxyXG4gICAgICAgICAgLm9yZGVyKCd1cGRhdGVkX2F0JywgeyBhc2NlbmRpbmc6IGZhbHNlIH0pO1xyXG5cclxuICAgICAgICBpZiAoZXJyb3IpIHtcclxuICAgICAgICAgIHRocm93IGVycm9yO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gSWYgd2UgaGF2ZSBkYXRhIGFuZCBpdCB3YXMgdXBkYXRlZCBpbiB0aGUgbGFzdCA1IG1pbnV0ZXMsIHVzZSBpdFxyXG4gICAgICAgIGNvbnN0IGZpdmVNaW51dGVzQWdvID0gbmV3IERhdGUoRGF0ZS5ub3coKSAtIDUgKiA2MCAqIDEwMDApLnRvSVNPU3RyaW5nKCk7XHJcbiAgICAgICAgY29uc3QgaGFzUmVjZW50RGF0YSA9IGRhdGEgJiYgZGF0YS5sZW5ndGggPiAwICYmIGRhdGFbMF0udXBkYXRlZF9hdCA+IGZpdmVNaW51dGVzQWdvO1xyXG5cclxuICAgICAgICBpZiAoaGFzUmVjZW50RGF0YSkge1xyXG4gICAgICAgICAgY29uc29sZS5sb2coJ1VzaW5nIHJlY2VudCBkYXRhIGZyb20gZGF0YWJhc2UnKTtcclxuICAgICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihkYXRhKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0gY2F0Y2ggKGRiRXJyKSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgcXVlcnlpbmcgZGF0YWJhc2U6JywgZGJFcnIpO1xyXG4gICAgICAgIC8vIENvbnRpbnVlIHRvIGNhbGN1bGF0aW5nIG5ldyBkYXRhXHJcbiAgICAgIH1cclxuXHJcbiAgICAgIC8vIE90aGVyd2lzZSwgZ2VuZXJhdGUgbmV3IGRhdGFcclxuICAgICAgY29uc29sZS5sb2coJ0dlbmVyYXRpbmcgbmV3IGNyb3dkIGRlbnNpdHkgZGF0YScpO1xyXG4gICAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHVwZGF0ZUNyb3dkRGVuc2l0eURhdGEoKTtcclxuICAgICAgICBcclxuICAgICAgICAvLyBJZiB3ZSBnb3QgZGF0YSBkaXJlY3RseSBmcm9tIHVwZGF0ZUNyb3dkRGVuc2l0eURhdGEsIHVzZSBpdFxyXG4gICAgICAgIGlmIChyZXN1bHQuZGF0YSkge1xyXG4gICAgICAgICAgY29uc29sZS5sb2coJ1VzaW5nIGRhdGEgcmV0dXJuZWQgZGlyZWN0bHkgZnJvbSB1cGRhdGVDcm93ZERlbnNpdHlEYXRhJyk7XHJcbiAgICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24ocmVzdWx0LmRhdGEpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICBpZiAoJ2Vycm9yJyBpbiByZXN1bHQpIHtcclxuICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgRmFpbGVkIHRvIHVwZGF0ZSBjcm93ZCBkZW5zaXR5IGRhdGE6ICR7cmVzdWx0LmVycm9yfWApO1xyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICAvLyBGZXRjaCB0aGUgbmV3bHkgaW5zZXJ0ZWQgZGF0YVxyXG4gICAgICAgIGNvbnN0IHsgZGF0YTogZnJlc2hEYXRhLCBlcnJvcjogZmV0Y2hFcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VBZG1pblxyXG4gICAgICAgICAgLmZyb20oJ2Nyb3dkX2RlbnNpdHknKVxyXG4gICAgICAgICAgLnNlbGVjdCgnKicpXHJcbiAgICAgICAgICAub3JkZXIoJ3VwZGF0ZWRfYXQnLCB7IGFzY2VuZGluZzogZmFsc2UgfSk7XHJcbiAgICAgICAgICBcclxuICAgICAgICBpZiAoZmV0Y2hFcnJvcikge1xyXG4gICAgICAgICAgdGhyb3cgZmV0Y2hFcnJvcjtcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKGZyZXNoRGF0YSk7XHJcbiAgICAgIH0gY2F0Y2ggKHVwZGF0ZUVycikge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGR1cmluZyBkYXRhIHVwZGF0ZTonLCB1cGRhdGVFcnIpO1xyXG4gICAgICAgIC8vIFVzZSBkaXJlY3QgY2FsY3VsYXRpb24gYXMgZmFsbGJhY2tcclxuICAgICAgICBjb25zdCBjYWxjdWxhdGVkRGF0YSA9IGF3YWl0IGNhbGN1bGF0ZVJlYWxpc3RpY0Nyb3dkRGVuc2l0aWVzKCk7XHJcbiAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKGNhbGN1bGF0ZWREYXRhKTtcclxuICAgICAgfVxyXG4gICAgfSBjYXRjaCAoc3VwYWJhc2VFcnIpIHtcclxuICAgICAgY29uc29sZS5lcnJvcignU3VwYWJhc2Ugb3BlcmF0aW9uIGVycm9yOicsIHN1cGFiYXNlRXJyKTtcclxuICAgICAgLy8gSWYgZGF0YWJhc2Ugb3BlcmF0aW9ucyBmYWlsLCByZXR1cm4gY2FsY3VsYXRlZCBkYXRhIGRpcmVjdGx5XHJcbiAgICAgIGNvbnN0IGNhbGN1bGF0ZWREYXRhID0gYXdhaXQgY2FsY3VsYXRlUmVhbGlzdGljQ3Jvd2REZW5zaXRpZXMoKTtcclxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKGNhbGN1bGF0ZWREYXRhKTtcclxuICAgIH1cclxuICB9IGNhdGNoIChtYWluRXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ01haW4gZXJyb3IgaGFuZGxlciBjYXVnaHQ6JywgbWFpbkVycm9yKTtcclxuICAgIC8vIEZpbmFsIGZhbGxiYWNrIC0gYWx3YXlzIHJldHVybiBjYWxjdWxhdGVkIGRhdGEgaWYgYWxsIGVsc2UgZmFpbHNcclxuICAgIHRyeSB7XHJcbiAgICAgIGNvbnN0IGNhbGN1bGF0ZWREYXRhID0gYXdhaXQgY2FsY3VsYXRlUmVhbGlzdGljQ3Jvd2REZW5zaXRpZXMoKTtcclxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKGNhbGN1bGF0ZWREYXRhKTtcclxuICAgIH0gY2F0Y2ggKGNhbGNFcnJvcikge1xyXG4gICAgICBjb25zb2xlLmVycm9yKCdFdmVuIGNhbGN1bGF0aW9uIGZhaWxlZDonLCBjYWxjRXJyb3IpO1xyXG4gICAgICAvLyBSZXR1cm4gZW1wdHkgYXJyYXkgaW5zdGVhZCBvZiBhbiBlcnJvciB0byBlbnN1cmUgSlNPTiBpcyByZXR1cm5lZFxyXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oW10pO1xyXG4gICAgfVxyXG4gIH1cclxufVxyXG5cclxuLy8gUE9TVCBoYW5kbGVyIHRvIHVwZGF0ZSBjcm93ZCBkZW5zaXR5IGRhdGFcclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIFBPU1QocmVxdWVzdDogUmVxdWVzdCkge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zb2xlLmxvZygnUE9TVCByZXF1ZXN0IHRvIGNyb3dkLWRlbnNpdHkgQVBJJyk7XHJcbiAgICBcclxuICAgIC8vIElmIHN1cGFiYXNlQWRtaW4gaXMgbm90IGF2YWlsYWJsZSwganVzdCByZWNhbGN1bGF0ZSBkaXJlY3RseVxyXG4gICAgaWYgKCFzdXBhYmFzZUFkbWluKSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKCdObyBzdXBhYmFzZUFkbWluIGNsaWVudCwgY2FsY3VsYXRpbmcgZGlyZWN0bHknKTtcclxuICAgICAgXHJcbiAgICAgIHRyeSB7XHJcbiAgICAgICAgLy8gR2V0IHJlcXVlc3QgYm9keVxyXG4gICAgICAgIGNvbnN0IGJvZHkgPSBhd2FpdCByZXF1ZXN0Lmpzb24oKTtcclxuICAgICAgICBcclxuICAgICAgICAvLyBDaGVjayBpZiBpdCdzIGEgcmVjYWxjdWxhdGlvbiByZXF1ZXN0XHJcbiAgICAgICAgaWYgKGJvZHkucmVjYWxjdWxhdGUgPT09IHRydWUpIHtcclxuICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHVwZGF0ZUNyb3dkRGVuc2l0eURhdGEoKTtcclxuICAgICAgICAgIFxyXG4gICAgICAgICAgLy8gVXNlIGRhdGEgZnJvbSB0aGUgcmVzdWx0IGlmIGF2YWlsYWJsZVxyXG4gICAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHtcclxuICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgICAgICAgbWVzc2FnZTogcmVzdWx0Lm1lc3NhZ2UgfHwgJ0Nyb3dkIGRlbnNpdHkgZGF0YSByZWNhbGN1bGF0ZWQgZGlyZWN0bHkgKG5vIERCKScsXHJcbiAgICAgICAgICAgIGNvdW50OiByZXN1bHQuY291bnQgfHwgMFxyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7XHJcbiAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgICAgIG1lc3NhZ2U6ICdNYW51YWwgZW50cnkgbm90IHN1cHBvcnRlZCB3aXRob3V0IGRhdGFiYXNlJ1xyXG4gICAgICAgIH0sIHsgc3RhdHVzOiA0MDAgfSk7XHJcbiAgICAgIH0gY2F0Y2ggKGVycikge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHBhcnNpbmcgcmVxdWVzdCBvciBjYWxjdWxhdGluZyBkZW5zaXR5OicsIGVycik7XHJcbiAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHtcclxuICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICAgICAgbWVzc2FnZTogJ0Vycm9yIHByb2Nlc3NpbmcgcmVxdWVzdCdcclxuICAgICAgICB9LCB7IHN0YXR1czogNDAwIH0pO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgdHJ5IHtcclxuICAgICAgLy8gR2V0IHJlcXVlc3QgYm9keVxyXG4gICAgICBjb25zdCBib2R5ID0gYXdhaXQgcmVxdWVzdC5qc29uKCk7XHJcbiAgICAgIFxyXG4gICAgICAvLyBDaGVjayBpZiBpdCdzIGEgcmVjYWxjdWxhdGlvbiByZXF1ZXN0XHJcbiAgICAgIGlmIChib2R5LnJlY2FsY3VsYXRlID09PSB0cnVlKSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coJ1JlY2FsY3VsYXRpb24gcmVxdWVzdCByZWNlaXZlZCcpO1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB1cGRhdGVDcm93ZERlbnNpdHlEYXRhKCk7XHJcbiAgICAgICAgICBcclxuICAgICAgICAgIC8vIElmIHdlIGhhdmUgZGF0YSBkaXJlY3RseSBpbiB0aGUgcmVzdWx0LCByZXBvcnQgc3VjY2Vzc1xyXG4gICAgICAgICAgaWYgKHJlc3VsdC5kYXRhKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7XHJcbiAgICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgICAgICAgICBtZXNzYWdlOiByZXN1bHQubWVzc2FnZSB8fCAnQ3Jvd2QgZGVuc2l0eSBkYXRhIHJlY2FsY3VsYXRlZCcsXHJcbiAgICAgICAgICAgICAgY291bnQ6IHJlc3VsdC5jb3VudCB8fCByZXN1bHQuZGF0YS5sZW5ndGhcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBcclxuICAgICAgICAgIGlmICgnZXJyb3InIGluIHJlc3VsdCkge1xyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEZhaWxlZCB0byByZWNhbGN1bGF0ZTogJHtyZXN1bHQuZXJyb3J9YCk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBcclxuICAgICAgICAgIGNvbnNvbGUubG9nKCdSZWNhbGN1bGF0aW9uIHN1Y2Nlc3NmdWw6JywgcmVzdWx0KTtcclxuICAgICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7XHJcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgICAgICAgIG1lc3NhZ2U6ICdDcm93ZCBkZW5zaXR5IGRhdGEgcmVjYWxjdWxhdGVkJyxcclxuICAgICAgICAgICAgY291bnQ6IChyZXN1bHQgYXMgYW55KS5jb3VudCB8fCAwXHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICB9IGNhdGNoIChyZWNhbGNFcnIpIHtcclxuICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ1JlY2FsY3VsYXRpb24gZXJyb3I6JywgcmVjYWxjRXJyKTtcclxuICAgICAgICAgIC8vIFJldHVybiBzdWNjZXNzIHdpdGggZGlyZWN0IGNhbGN1bGF0aW9uXHJcbiAgICAgICAgICBjb25zdCBjYWxjdWxhdGVkRGF0YSA9IGF3YWl0IGNhbGN1bGF0ZVJlYWxpc3RpY0Nyb3dkRGVuc2l0aWVzKCk7XHJcbiAgICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oe1xyXG4gICAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxyXG4gICAgICAgICAgICBtZXNzYWdlOiAnVXNlZCBkaXJlY3QgY2FsY3VsYXRpb24gKERCIHVwZGF0ZSBmYWlsZWQpJyxcclxuICAgICAgICAgICAgY291bnQ6IGNhbGN1bGF0ZWREYXRhLmxlbmd0aFxyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIFxyXG4gICAgICAvLyBPdGhlcndpc2UgaGFuZGxlIG1hbnVhbCBlbnRyeVxyXG4gICAgICBjb25zb2xlLmxvZygnTWFudWFsIGVudHJ5IHJlcXVlc3QgcmVjZWl2ZWQnKTtcclxuICAgICAgXHJcbiAgICAgIC8vIFZhbGlkYXRlIHJlcXVlc3QgYm9keVxyXG4gICAgICBpZiAoIWJvZHkubG9jYXRpb25fbmFtZSB8fCAhYm9keS5jb29yZGluYXRlcyB8fCAhYm9keS5kZW5zaXR5X2xldmVsKSB7XHJcbiAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxyXG4gICAgICAgICAgeyBlcnJvcjogJ01pc3NpbmcgcmVxdWlyZWQgZmllbGRzJyB9LFxyXG4gICAgICAgICAgeyBzdGF0dXM6IDQwMCB9XHJcbiAgICAgICAgKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgLy8gVXBkYXRlIG9yIGluc2VydCBjcm93ZCBkZW5zaXR5IGRhdGFcclxuICAgICAgdHJ5IHtcclxuICAgICAgICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZUFkbWluXHJcbiAgICAgICAgICAuZnJvbSgnY3Jvd2RfZGVuc2l0eScpXHJcbiAgICAgICAgICAudXBzZXJ0KHtcclxuICAgICAgICAgICAgbG9jYXRpb25fbmFtZTogYm9keS5sb2NhdGlvbl9uYW1lLFxyXG4gICAgICAgICAgICBjb29yZGluYXRlczogYm9keS5jb29yZGluYXRlcyxcclxuICAgICAgICAgICAgZGVuc2l0eV9sZXZlbDogYm9keS5kZW5zaXR5X2xldmVsLFxyXG4gICAgICAgICAgICB1cGRhdGVkX2F0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXHJcbiAgICAgICAgICAgIGNyb3dkX3NpemU6IGJvZHkuY3Jvd2Rfc2l6ZSB8fCBudWxsLFxyXG4gICAgICAgICAgICBvY2N1cGFuY3lfcGVyY2VudGFnZTogYm9keS5vY2N1cGFuY3lfcGVyY2VudGFnZSB8fCBudWxsLFxyXG4gICAgICAgICAgICBtZXRhX2RhdGE6IGJvZHkubWV0YV9kYXRhIHx8IG51bGxcclxuICAgICAgICAgIH0pXHJcbiAgICAgICAgICAuc2VsZWN0KCk7XHJcblxyXG4gICAgICAgIGlmIChlcnJvcikge1xyXG4gICAgICAgICAgdGhyb3cgZXJyb3I7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oZGF0YSk7XHJcbiAgICAgIH0gY2F0Y2ggKHVwc2VydEVycikge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGR1cmluZyB1cHNlcnQgb3BlcmF0aW9uOicsIHVwc2VydEVycik7XHJcbiAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxyXG4gICAgICAgICAgeyBlcnJvcjogJ0RhdGFiYXNlIHVwZGF0ZSBmYWlsZWQsIGJ1dCByZXF1ZXN0IHdhcyB2YWxpZCcgfSxcclxuICAgICAgICAgIHsgc3RhdHVzOiA1MDAgfVxyXG4gICAgICAgICk7XHJcbiAgICAgIH1cclxuICAgIH0gY2F0Y2ggKGJvZHlFcnIpIHtcclxuICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgcGFyc2luZyByZXF1ZXN0IGJvZHk6JywgYm9keUVycik7XHJcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcclxuICAgICAgICB7IGVycm9yOiAnSW52YWxpZCByZXF1ZXN0IGZvcm1hdCcgfSxcclxuICAgICAgICB7IHN0YXR1czogNDAwIH1cclxuICAgICAgKTtcclxuICAgIH1cclxuICB9IGNhdGNoIChtYWluRXJyKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdVbmhhbmRsZWQgZXJyb3IgaW4gUE9TVCBoYW5kbGVyOicsIG1haW5FcnIpO1xyXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxyXG4gICAgICB7IGVycm9yOiAnU2VydmVyIGVycm9yIHByb2Nlc3NpbmcgcmVxdWVzdCcgfSxcclxuICAgICAgeyBzdGF0dXM6IDUwMCB9XHJcbiAgICApO1xyXG4gIH1cclxufSAiXSwibmFtZXMiOlsiTmV4dFJlc3BvbnNlIiwic3VwYWJhc2VBZG1pbiIsInVwZGF0ZUNyb3dkRGVuc2l0eURhdGEiLCJjYWxjdWxhdGVSZWFsaXN0aWNDcm93ZERlbnNpdGllcyIsIkdFVCIsInJlcXVlc3QiLCJjb25zb2xlIiwibG9nIiwicHJvY2VzcyIsImVudiIsIk5FWFRfUFVCTElDX1NVUEFCQVNFX1VSTCIsIk5FWFRfUFVCTElDX1NVUEFCQVNFX0FOT05fS0VZIiwiU1VQQUJBU0VfU0VSVklDRV9ST0xFX0tFWSIsInNlYXJjaFBhcmFtcyIsIlVSTCIsInVybCIsImZvcmNlUmVmcmVzaCIsImdldCIsImNhbGN1bGF0ZWREYXRhIiwianNvbiIsInJlc3VsdCIsImRhdGEiLCJlcnJvciIsImZyZXNoRGF0YSIsImZldGNoRXJyb3IiLCJmcm9tIiwic2VsZWN0Iiwib3JkZXIiLCJhc2NlbmRpbmciLCJkYkVyciIsImZpdmVNaW51dGVzQWdvIiwiRGF0ZSIsIm5vdyIsInRvSVNPU3RyaW5nIiwiaGFzUmVjZW50RGF0YSIsImxlbmd0aCIsInVwZGF0ZWRfYXQiLCJFcnJvciIsInVwZGF0ZUVyciIsInN1cGFiYXNlRXJyIiwibWFpbkVycm9yIiwiY2FsY0Vycm9yIiwiUE9TVCIsImJvZHkiLCJyZWNhbGN1bGF0ZSIsInN1Y2Nlc3MiLCJtZXNzYWdlIiwiY291bnQiLCJzdGF0dXMiLCJlcnIiLCJyZWNhbGNFcnIiLCJsb2NhdGlvbl9uYW1lIiwiY29vcmRpbmF0ZXMiLCJkZW5zaXR5X2xldmVsIiwidXBzZXJ0IiwiY3Jvd2Rfc2l6ZSIsIm9jY3VwYW5jeV9wZXJjZW50YWdlIiwibWV0YV9kYXRhIiwidXBzZXJ0RXJyIiwiYm9keUVyciIsIm1haW5FcnIiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/app/api/crowd-density/route.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/crowdSensors.ts":
/*!*********************************!*\
  !*** ./src/lib/crowdSensors.ts ***!
  \*********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   calculateRealisticCrowdDensities: () => (/* binding */ calculateRealisticCrowdDensities),\n/* harmony export */   updateCrowdDensityData: () => (/* binding */ updateCrowdDensityData)\n/* harmony export */ });\n/* harmony import */ var _supabase__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./supabase */ \"(rsc)/./src/lib/supabase.ts\");\n// Simulated crowd density sensor network for Hajj sites\n\n// Total pilgrims range: 250,000 - 350,000\nconst TOTAL_PILGRIMS_MIN = 250000;\nconst TOTAL_PILGRIMS_MAX = 350000;\nconst TOTAL_PILGRIMS_AVG = Math.floor((TOTAL_PILGRIMS_MIN + TOTAL_PILGRIMS_MAX) / 2);\n// Define physical space characteristics for each location\nconst LOCATION_SIZES = {\n    \"Masjid al-Haram\": {\n        areaInSquareMeters: 356800,\n        capacity: 120000,\n        sections: [\n            {\n                id: \"mataf\",\n                name: \"Mataf Area\",\n                percentage: 0.15\n            },\n            {\n                id: \"ground\",\n                name: \"Ground Floor\",\n                percentage: 0.45\n            },\n            {\n                id: \"first\",\n                name: \"First Floor\",\n                percentage: 0.25\n            },\n            {\n                id: \"roof\",\n                name: \"Roof Area\",\n                percentage: 0.15\n            }\n        ]\n    },\n    \"Mina\": {\n        areaInSquareMeters: 812000,\n        capacity: 240000,\n        sections: [\n            {\n                id: \"tents-a\",\n                name: \"Tents Area A\",\n                percentage: 0.3\n            },\n            {\n                id: \"tents-b\",\n                name: \"Tents Area B\",\n                percentage: 0.3\n            },\n            {\n                id: \"tents-c\",\n                name: \"Tents Area C\",\n                percentage: 0.3\n            },\n            {\n                id: \"services\",\n                name: \"Services Area\",\n                percentage: 0.1\n            }\n        ]\n    },\n    \"Jamaraat Bridge\": {\n        areaInSquareMeters: 52000,\n        capacity: 100000,\n        sections: [\n            {\n                id: \"lower\",\n                name: \"Lower Level\",\n                percentage: 0.3\n            },\n            {\n                id: \"middle\",\n                name: \"Middle Level\",\n                percentage: 0.4\n            },\n            {\n                id: \"upper\",\n                name: \"Upper Level\",\n                percentage: 0.3\n            }\n        ]\n    },\n    \"Arafat\": {\n        areaInSquareMeters: 1456000,\n        capacity: 300000,\n        sections: [\n            {\n                id: \"jabal\",\n                name: \"Jabal al-Rahmah\",\n                percentage: 0.2\n            },\n            {\n                id: \"nimrah\",\n                name: \"Nimrah\",\n                percentage: 0.3\n            },\n            {\n                id: \"uranah\",\n                name: \"Uranah\",\n                percentage: 0.25\n            },\n            {\n                id: \"other\",\n                name: \"Other Areas\",\n                percentage: 0.25\n            }\n        ]\n    },\n    \"Muzdalifah\": {\n        areaInSquareMeters: 623000,\n        capacity: 250000,\n        sections: [\n            {\n                id: \"mash\",\n                name: \"Al-Mash'ar al-Haram\",\n                percentage: 0.3\n            },\n            {\n                id: \"north\",\n                name: \"Northern Area\",\n                percentage: 0.35\n            },\n            {\n                id: \"south\",\n                name: \"Southern Area\",\n                percentage: 0.35\n            }\n        ]\n    },\n    // Additional locations\n    \"Mina Entrance Gate 1\": {\n        areaInSquareMeters: 3000,\n        capacity: 15000,\n        sections: [\n            {\n                id: \"entry\",\n                name: \"Entry Points\",\n                percentage: 0.4\n            },\n            {\n                id: \"security\",\n                name: \"Security Check\",\n                percentage: 0.3\n            },\n            {\n                id: \"waiting\",\n                name: \"Waiting Area\",\n                percentage: 0.3\n            }\n        ]\n    },\n    \"Tent City Section A\": {\n        areaInSquareMeters: 120000,\n        capacity: 80000,\n        sections: [\n            {\n                id: \"a1\",\n                name: \"Block A1\",\n                percentage: 0.25\n            },\n            {\n                id: \"a2\",\n                name: \"Block A2\",\n                percentage: 0.25\n            },\n            {\n                id: \"a3\",\n                name: \"Block A3\",\n                percentage: 0.25\n            },\n            {\n                id: \"a4\",\n                name: \"Block A4\",\n                percentage: 0.25\n            }\n        ]\n    },\n    \"Jamarat Central Access\": {\n        areaInSquareMeters: 8000,\n        capacity: 30000,\n        sections: [\n            {\n                id: \"entry\",\n                name: \"Entry Zone\",\n                percentage: 0.4\n            },\n            {\n                id: \"corridor\",\n                name: \"Main Corridor\",\n                percentage: 0.4\n            },\n            {\n                id: \"exit\",\n                name: \"Exit Zone\",\n                percentage: 0.2\n            }\n        ]\n    }\n};\n// Calculate the sum of all location capacities to verify against total pilgrims\nconst TOTAL_CAPACITY = Object.values(LOCATION_SIZES).reduce((sum, location)=>sum + location.capacity, 0);\n// Define density threshold levels (people per square meter)\n// Adjusted for the pilgrims count of 250,000-350,000\nconst DENSITY_THRESHOLDS = {\n    low: 0.3,\n    medium: 0.8,\n    high: 1.5\n};\n// Time-based modifiers for various Hajj periods - increase/decrease multiplier\nconst TIME_MODIFIERS = {\n    beforePrayer: 2.0,\n    duringPrayer: 2.5,\n    afterPrayer: 1.8,\n    jamarat: 3.0,\n    tawaf: 2.5,\n    sayee: 2.0,\n    night: 0.7,\n    earlyMorning: 0.8,\n    hajjDay: 3.0\n};\n// Weather impacts on crowd behavior\nconst WEATHER_MODIFIERS = {\n    hot: 0.9,\n    rain: 0.7,\n    pleasant: 1.2\n};\n// Function to get realistic crowd densities based on various factors\nasync function calculateRealisticCrowdDensities() {\n    const now = new Date();\n    const hour = now.getHours();\n    const locations = Object.keys(LOCATION_SIZES);\n    // Determine current factors affecting density\n    let timeModifier = 1.0;\n    // Time of day adjustments\n    if (hour >= 22 || hour < 4) {\n        timeModifier = TIME_MODIFIERS.night;\n    } else if (hour >= 4 && hour < 6) {\n        timeModifier = TIME_MODIFIERS.earlyMorning;\n    } else if ([\n        5,\n        12,\n        15,\n        18,\n        20\n    ].includes(hour)) {\n        // Prayer times\n        timeModifier = TIME_MODIFIERS.duringPrayer;\n    } else if ([\n        6,\n        13,\n        16,\n        19,\n        21\n    ].includes(hour)) {\n        // After prayer\n        timeModifier = TIME_MODIFIERS.afterPrayer;\n    } else if ([\n        4,\n        11,\n        14,\n        17,\n        19\n    ].includes(hour)) {\n        // Before prayer\n        timeModifier = TIME_MODIFIERS.beforePrayer;\n    }\n    // Special time adjustments for specific locations\n    const jamarat_hours = [\n        6,\n        7,\n        8,\n        13,\n        14,\n        15,\n        16\n    ];\n    const tawaf_hours = [\n        5,\n        6,\n        7,\n        21,\n        22,\n        23\n    ];\n    // Hajj day simulation (based on month/day/hour)\n    // For demo purposes, we'll simulate one day of the week as Hajj day\n    const isHajjDay = now.getDay() === 5; // Friday for demo purposes\n    // For demo purposes, force \"Hajj day\" behavior when minutes are divisible by 3\n    const forcedHajjDay = now.getMinutes() % 3 === 0;\n    // Weather simulation (simplified)\n    // For demo, we'll base it on time of day in Mecca which is typically hot midday\n    let weatherModifier = 1.0;\n    if (hour >= 11 && hour <= 15) {\n        weatherModifier = WEATHER_MODIFIERS.hot;\n    } else if (hour >= 16 && hour <= 18) {\n        weatherModifier = WEATHER_MODIFIERS.pleasant;\n    }\n    // Determine current total pilgrim count - varies within the range\n    // Use minute of the hour to create some natural variation\n    const pilgrimVariation = now.getMinutes() / 60 * (TOTAL_PILGRIMS_MAX - TOTAL_PILGRIMS_MIN);\n    const currentTotalPilgrims = TOTAL_PILGRIMS_MIN + Math.floor(pilgrimVariation);\n    // Generate realistic crowd density for each location\n    const densityData = locations.map((locationName, index)=>{\n        const locationData = LOCATION_SIZES[locationName];\n        // Apply location-specific modifiers\n        let locationTimeModifier = timeModifier;\n        if (locationName === \"Jamaraat Bridge\" && jamarat_hours.includes(hour)) {\n            locationTimeModifier = TIME_MODIFIERS.jamarat;\n        } else if (locationName === \"Masjid al-Haram\" && tawaf_hours.includes(hour)) {\n            locationTimeModifier = TIME_MODIFIERS.tawaf;\n        } else if (locationName === \"Arafat\" && (isHajjDay || forcedHajjDay)) {\n            locationTimeModifier = TIME_MODIFIERS.hajjDay;\n        }\n        // Use deterministic calculations for density based on location and time\n        // instead of fully random to ensure consistent patterns\n        let baseOccupancyPercentage;\n        // Calculate location's portion of total pilgrims\n        const locationCapacityRatio = locationData.capacity / TOTAL_CAPACITY;\n        const baseExpectedPilgrims = currentTotalPilgrims * locationCapacityRatio;\n        // Each location has different baseline crowd patterns\n        switch(locationName){\n            case \"Masjid al-Haram\":\n                // Masjid al-Haram is consistently busier\n                baseOccupancyPercentage = 0.7 + hour % 3 * 0.1;\n                break;\n            case \"Jamaraat Bridge\":\n                // Jamarat is extremely busy during specific hours\n                if (jamarat_hours.includes(hour)) {\n                    baseOccupancyPercentage = 0.9;\n                } else {\n                    baseOccupancyPercentage = 0.5;\n                }\n                break;\n            case \"Mina\":\n                // Mina varies significantly by day\n                baseOccupancyPercentage = isHajjDay || forcedHajjDay ? 0.95 : 0.6;\n                break;\n            case \"Arafat\":\n                // Arafat is extremely busy on Hajj day, empty otherwise\n                baseOccupancyPercentage = isHajjDay || forcedHajjDay ? 0.98 : 0.3;\n                break;\n            case \"Muzdalifah\":\n                // Muzdalifah is busy in the evening\n                baseOccupancyPercentage = hour >= 18 && hour <= 23 ? 0.85 : 0.4;\n                break;\n            default:\n                // Use minutes/seconds as a seed for other locations to get variation\n                baseOccupancyPercentage = 0.4 + now.getMinutes() % 10 / 10;\n        }\n        // DEMO: For demonstration purposes, ensure we have a mix of all density levels\n        // Force some locations to specific density levels\n        if (index % 5 === 0) {\n            // Every 5th location (by order) is forced to high density\n            baseOccupancyPercentage = 0.9;\n            locationTimeModifier = 2.0;\n        } else if (index % 5 === 1) {\n            // Every 5th+1 location is forced to medium density\n            baseOccupancyPercentage = 0.7;\n            locationTimeModifier = 1.5;\n        } else if (index % 5 === 2) {\n            // Every 5th+2 location is forced to critical density\n            baseOccupancyPercentage = 1.0;\n            locationTimeModifier = 2.5;\n        } else if (index % 5 === 3) {\n            // Every 5th+3 location is forced to low density\n            baseOccupancyPercentage = 0.4;\n            locationTimeModifier = 1.0;\n        }\n        // Every 5th+4 location uses the natural calculation\n        // Apply all modifiers\n        const modifiedOccupancy = baseOccupancyPercentage * locationTimeModifier * weatherModifier;\n        // Add slight randomness (±5% instead of ±10% for more consistency)\n        const finalOccupancy = modifiedOccupancy * (0.95 + Math.random() * 0.1);\n        // Calculate actual crowd size based on occupancy percentage and capacity\n        const crowdSize = Math.floor(finalOccupancy * locationData.capacity);\n        // Calculate density (people per square meter)\n        const density = crowdSize / locationData.areaInSquareMeters;\n        // Determine density level based on thresholds\n        let densityLevel;\n        if (density <= DENSITY_THRESHOLDS.low) {\n            densityLevel = \"low\";\n        } else if (density <= DENSITY_THRESHOLDS.medium) {\n            densityLevel = \"medium\";\n        } else if (density <= DENSITY_THRESHOLDS.high) {\n            densityLevel = \"high\";\n        } else {\n            densityLevel = \"critical\";\n        }\n        // Generate section-specific data\n        const sectionData = locationData.sections.map((section)=>{\n            // Each section has slightly different occupancy\n            const sectionVariation = 0.9 + Math.random() * 0.2; // 90-110% of location average\n            const sectionDensity = density * sectionVariation;\n            // Determine section density level\n            let sectionDensityLevel;\n            if (sectionDensity <= DENSITY_THRESHOLDS.low) {\n                sectionDensityLevel = \"low\";\n            } else if (sectionDensity <= DENSITY_THRESHOLDS.medium) {\n                sectionDensityLevel = \"medium\";\n            } else if (sectionDensity <= DENSITY_THRESHOLDS.high) {\n                sectionDensityLevel = \"high\";\n            } else {\n                sectionDensityLevel = \"critical\";\n            }\n            return {\n                id: section.id,\n                name: section.name,\n                density: sectionDensity.toFixed(2),\n                density_level: sectionDensityLevel,\n                crowd_size: Math.floor(crowdSize * section.percentage)\n            };\n        });\n        // Add some randomness to the exact coordinates to represent different areas\n        const baseCoordinates = getBaseCoordinates(locationName);\n        const coordinates = {\n            lng: baseCoordinates.lng + (Math.random() * 0.0005 - 0.00025),\n            lat: baseCoordinates.lat + (Math.random() * 0.0005 - 0.00025)\n        };\n        return {\n            location_name: locationName,\n            coordinates: coordinates,\n            density: density.toFixed(2),\n            density_level: densityLevel,\n            crowd_size: crowdSize,\n            capacity: locationData.capacity,\n            occupancy_percentage: (finalOccupancy * 100).toFixed(1),\n            sections: sectionData,\n            timestamp: new Date().toISOString(),\n            meta_data: {\n                density: parseFloat(density.toFixed(2)),\n                capacity: locationData.capacity,\n                sections: sectionData,\n                current_total_pilgrims: currentTotalPilgrims\n            }\n        };\n    });\n    // Debug information about total pilgrim distribution\n    const totalCrowdSize = densityData.reduce((sum, location)=>sum + location.crowd_size, 0);\n    console.log(`Total pilgrims currently distributed: ${totalCrowdSize} (target: ${currentTotalPilgrims})`);\n    return densityData;\n}\n// Function to update database with calculated density\nasync function updateCrowdDensityData() {\n    try {\n        console.log(\"Starting updateCrowdDensityData\");\n        const densityData = await calculateRealisticCrowdDensities();\n        console.log(`Generated ${densityData.length} density data points`);\n        // Log density levels for debugging\n        console.log(\"Current density levels:\");\n        densityData.forEach((location)=>{\n            console.log(`${location.location_name}: ${location.density_level} (${location.density})`);\n        });\n        if (!_supabase__WEBPACK_IMPORTED_MODULE_0__.supabaseAdmin) {\n            console.log(\"Supabase admin client not available, returning calculated data directly\");\n            return {\n                success: true,\n                count: densityData.length,\n                data: densityData,\n                message: \"Database connection not available, using calculated data\"\n            };\n        }\n        // Clear existing data and insert new data\n        try {\n            console.log(\"Attempting to clear existing data\");\n            const { error: deleteError } = await _supabase__WEBPACK_IMPORTED_MODULE_0__.supabaseAdmin.from(\"crowd_density\").delete().neq(\"id\", 0); // Delete all records\n            if (deleteError) {\n                console.error(\"Error clearing existing data:\", deleteError);\n                return {\n                    success: true,\n                    error: deleteError,\n                    data: densityData,\n                    count: densityData.length,\n                    message: \"Failed to clear existing data, but returning calculated data\"\n                };\n            }\n            // Insert new data\n            console.log(\"Preparing data for insertion\");\n            const upsertData = densityData.map((location)=>({\n                    location_name: location.location_name,\n                    coordinates: location.coordinates,\n                    density_level: location.density_level,\n                    updated_at: new Date().toISOString(),\n                    crowd_size: location.crowd_size,\n                    occupancy_percentage: location.occupancy_percentage,\n                    meta_data: {\n                        density: location.density,\n                        capacity: location.capacity,\n                        sections: location.sections,\n                        current_total_pilgrims: location.meta_data.current_total_pilgrims\n                    }\n                }));\n            console.log(\"Attempting to insert data into Supabase\");\n            const { error: insertError } = await _supabase__WEBPACK_IMPORTED_MODULE_0__.supabaseAdmin.from(\"crowd_density\").insert(upsertData);\n            if (insertError) {\n                console.error(\"Error inserting crowd density data:\", insertError);\n                return {\n                    success: true,\n                    error: insertError,\n                    data: densityData,\n                    count: densityData.length,\n                    message: \"Failed to insert data, but returning calculated data\"\n                };\n            }\n            console.log(\"Successfully updated crowd density data\");\n            return {\n                success: true,\n                count: densityData.length,\n                data: densityData\n            };\n        } catch (dbError) {\n            console.error(\"Database operation error:\", dbError);\n            return {\n                success: true,\n                error: dbError,\n                data: densityData,\n                count: densityData.length,\n                message: \"Database error, but returning calculated data\"\n            };\n        }\n    } catch (error) {\n        console.error(\"Error in updateCrowdDensityData:\", error);\n        // Try to return calculated data directly as a fallback\n        try {\n            const directData = await calculateRealisticCrowdDensities();\n            return {\n                success: true,\n                error,\n                data: directData,\n                count: directData.length,\n                message: \"Error occurred but returning direct calculation\"\n            };\n        } catch (calcError) {\n            console.error(\"Failed even direct calculation:\", calcError);\n            return {\n                error: \"Complete calculation failure\"\n            };\n        }\n    }\n}\n// Helper function to get base coordinates for each location\nfunction getBaseCoordinates(locationName) {\n    const coordinatesMap = {\n        \"Masjid al-Haram\": {\n            lng: 39.826174,\n            lat: 21.422487\n        },\n        \"Mina\": {\n            lng: 39.892966,\n            lat: 21.413249\n        },\n        \"Jamaraat Bridge\": {\n            lng: 39.873485,\n            lat: 21.42365\n        },\n        \"Arafat\": {\n            lng: 39.984687,\n            lat: 21.355461\n        },\n        \"Muzdalifah\": {\n            lng: 39.936322,\n            lat: 21.383082\n        },\n        \"Mina Entrance Gate 1\": {\n            lng: 39.887235,\n            lat: 21.411856\n        },\n        \"Tent City Section A\": {\n            lng: 39.889124,\n            lat: 21.414501\n        },\n        \"Jamarat Central Access\": {\n            lng: 39.871952,\n            lat: 21.423850\n        }\n    };\n    return coordinatesMap[locationName] || {\n        lng: 39.826174,\n        lat: 21.422487\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QixjQUFjLENBQUN2RCxhQUFhLElBQUk7UUFBRXdCLEtBQUs7UUFBV0MsS0FBSztJQUFVO0FBQzFFIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vaGFqai1uYXZpZ2F0b3IvLi9zcmMvbGliL2Nyb3dkU2Vuc29ycy50cz9iZDRlIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIFNpbXVsYXRlZCBjcm93ZCBkZW5zaXR5IHNlbnNvciBuZXR3b3JrIGZvciBIYWpqIHNpdGVzXHJcbmltcG9ydCB7IHN1cGFiYXNlQWRtaW4gfSBmcm9tICcuL3N1cGFiYXNlJztcclxuXHJcbi8vIERlZmluZSB0eXBlcyBmb3Igb3VyIGxvY2F0aW9ucyBkYXRhXHJcbnR5cGUgTG9jYXRpb25TZWN0aW9uID0ge1xyXG4gIGlkOiBzdHJpbmc7XHJcbiAgbmFtZTogc3RyaW5nO1xyXG4gIHBlcmNlbnRhZ2U6IG51bWJlcjtcclxufTtcclxuXHJcbnR5cGUgTG9jYXRpb25EYXRhID0ge1xyXG4gIGFyZWFJblNxdWFyZU1ldGVyczogbnVtYmVyO1xyXG4gIGNhcGFjaXR5OiBudW1iZXI7XHJcbiAgc2VjdGlvbnM6IExvY2F0aW9uU2VjdGlvbltdO1xyXG59O1xyXG5cclxudHlwZSBDb29yZGluYXRlcyA9IHtcclxuICBsbmc6IG51bWJlcjtcclxuICBsYXQ6IG51bWJlcjtcclxufTtcclxuXHJcbnR5cGUgRGVuc2l0eUxldmVsID0gJ2xvdycgfCAnbWVkaXVtJyB8ICdoaWdoJyB8ICdjcml0aWNhbCc7XHJcblxyXG4vLyBUb3RhbCBwaWxncmltcyByYW5nZTogMjUwLDAwMCAtIDM1MCwwMDBcclxuY29uc3QgVE9UQUxfUElMR1JJTVNfTUlOID0gMjUwMDAwO1xyXG5jb25zdCBUT1RBTF9QSUxHUklNU19NQVggPSAzNTAwMDA7XHJcbmNvbnN0IFRPVEFMX1BJTEdSSU1TX0FWRyA9IE1hdGguZmxvb3IoKFRPVEFMX1BJTEdSSU1TX01JTiArIFRPVEFMX1BJTEdSSU1TX01BWCkgLyAyKTtcclxuXHJcbi8vIERlZmluZSBwaHlzaWNhbCBzcGFjZSBjaGFyYWN0ZXJpc3RpY3MgZm9yIGVhY2ggbG9jYXRpb25cclxuY29uc3QgTE9DQVRJT05fU0laRVM6IFJlY29yZDxzdHJpbmcsIExvY2F0aW9uRGF0YT4gPSB7XHJcbiAgJ01hc2ppZCBhbC1IYXJhbSc6IHtcclxuICAgIGFyZWFJblNxdWFyZU1ldGVyczogMzU2ODAwLCAvLyBUb3RhbCBhcmVhIGluY2x1ZGluZyBleHBhbmRlZCBwYXJ0c1xyXG4gICAgY2FwYWNpdHk6IDEyMDAwMCwgLy8gTWF4aW11bSBjYXBhY2l0eSBhZGp1c3RlZCBmb3IgcGlsZ3JpbXMgY291bnRcclxuICAgIHNlY3Rpb25zOiBbXHJcbiAgICAgIHsgaWQ6ICdtYXRhZicsIG5hbWU6ICdNYXRhZiBBcmVhJywgcGVyY2VudGFnZTogMC4xNSB9LFxyXG4gICAgICB7IGlkOiAnZ3JvdW5kJywgbmFtZTogJ0dyb3VuZCBGbG9vcicsIHBlcmNlbnRhZ2U6IDAuNDUgfSxcclxuICAgICAgeyBpZDogJ2ZpcnN0JywgbmFtZTogJ0ZpcnN0IEZsb29yJywgcGVyY2VudGFnZTogMC4yNSB9LFxyXG4gICAgICB7IGlkOiAncm9vZicsIG5hbWU6ICdSb29mIEFyZWEnLCBwZXJjZW50YWdlOiAwLjE1IH1cclxuICAgIF1cclxuICB9LFxyXG4gICdNaW5hJzoge1xyXG4gICAgYXJlYUluU3F1YXJlTWV0ZXJzOiA4MTIwMDAsXHJcbiAgICBjYXBhY2l0eTogMjQwMDAwLCAvLyBBZGp1c3RlZCBmb3IgcGlsZ3JpbXMgY291bnRcclxuICAgIHNlY3Rpb25zOiBbXHJcbiAgICAgIHsgaWQ6ICd0ZW50cy1hJywgbmFtZTogJ1RlbnRzIEFyZWEgQScsIHBlcmNlbnRhZ2U6IDAuMyB9LFxyXG4gICAgICB7IGlkOiAndGVudHMtYicsIG5hbWU6ICdUZW50cyBBcmVhIEInLCBwZXJjZW50YWdlOiAwLjMgfSxcclxuICAgICAgeyBpZDogJ3RlbnRzLWMnLCBuYW1lOiAnVGVudHMgQXJlYSBDJywgcGVyY2VudGFnZTogMC4zIH0sXHJcbiAgICAgIHsgaWQ6ICdzZXJ2aWNlcycsIG5hbWU6ICdTZXJ2aWNlcyBBcmVhJywgcGVyY2VudGFnZTogMC4xIH1cclxuICAgIF1cclxuICB9LFxyXG4gICdKYW1hcmFhdCBCcmlkZ2UnOiB7XHJcbiAgICBhcmVhSW5TcXVhcmVNZXRlcnM6IDUyMDAwLFxyXG4gICAgY2FwYWNpdHk6IDEwMDAwMCwgLy8gSG91cmx5IGNhcGFjaXR5IGFkanVzdGVkXHJcbiAgICBzZWN0aW9uczogW1xyXG4gICAgICB7IGlkOiAnbG93ZXInLCBuYW1lOiAnTG93ZXIgTGV2ZWwnLCBwZXJjZW50YWdlOiAwLjMgfSxcclxuICAgICAgeyBpZDogJ21pZGRsZScsIG5hbWU6ICdNaWRkbGUgTGV2ZWwnLCBwZXJjZW50YWdlOiAwLjQgfSxcclxuICAgICAgeyBpZDogJ3VwcGVyJywgbmFtZTogJ1VwcGVyIExldmVsJywgcGVyY2VudGFnZTogMC4zIH1cclxuICAgIF1cclxuICB9LFxyXG4gICdBcmFmYXQnOiB7XHJcbiAgICBhcmVhSW5TcXVhcmVNZXRlcnM6IDE0NTYwMDAsXHJcbiAgICBjYXBhY2l0eTogMzAwMDAwLCAvLyBBZGp1c3RlZCBmb3IgcGlsZ3JpbXMgY291bnRcclxuICAgIHNlY3Rpb25zOiBbXHJcbiAgICAgIHsgaWQ6ICdqYWJhbCcsIG5hbWU6ICdKYWJhbCBhbC1SYWhtYWgnLCBwZXJjZW50YWdlOiAwLjIgfSxcclxuICAgICAgeyBpZDogJ25pbXJhaCcsIG5hbWU6ICdOaW1yYWgnLCBwZXJjZW50YWdlOiAwLjMgfSxcclxuICAgICAgeyBpZDogJ3VyYW5haCcsIG5hbWU6ICdVcmFuYWgnLCBwZXJjZW50YWdlOiAwLjI1IH0sXHJcbiAgICAgIHsgaWQ6ICdvdGhlcicsIG5hbWU6ICdPdGhlciBBcmVhcycsIHBlcmNlbnRhZ2U6IDAuMjUgfVxyXG4gICAgXVxyXG4gIH0sXHJcbiAgJ011emRhbGlmYWgnOiB7XHJcbiAgICBhcmVhSW5TcXVhcmVNZXRlcnM6IDYyMzAwMCxcclxuICAgIGNhcGFjaXR5OiAyNTAwMDAsIC8vIEFkanVzdGVkIGZvciBwaWxncmltcyBjb3VudFxyXG4gICAgc2VjdGlvbnM6IFtcclxuICAgICAgeyBpZDogJ21hc2gnLCBuYW1lOiAnQWwtTWFzaFxcJ2FyIGFsLUhhcmFtJywgcGVyY2VudGFnZTogMC4zIH0sXHJcbiAgICAgIHsgaWQ6ICdub3J0aCcsIG5hbWU6ICdOb3J0aGVybiBBcmVhJywgcGVyY2VudGFnZTogMC4zNSB9LFxyXG4gICAgICB7IGlkOiAnc291dGgnLCBuYW1lOiAnU291dGhlcm4gQXJlYScsIHBlcmNlbnRhZ2U6IDAuMzUgfVxyXG4gICAgXVxyXG4gIH0sXHJcbiAgLy8gQWRkaXRpb25hbCBsb2NhdGlvbnNcclxuICAnTWluYSBFbnRyYW5jZSBHYXRlIDEnOiB7XHJcbiAgICBhcmVhSW5TcXVhcmVNZXRlcnM6IDMwMDAsXHJcbiAgICBjYXBhY2l0eTogMTUwMDAsIC8vIEhvdXJseSBjYXBhY2l0eVxyXG4gICAgc2VjdGlvbnM6IFtcclxuICAgICAgeyBpZDogJ2VudHJ5JywgbmFtZTogJ0VudHJ5IFBvaW50cycsIHBlcmNlbnRhZ2U6IDAuNCB9LFxyXG4gICAgICB7IGlkOiAnc2VjdXJpdHknLCBuYW1lOiAnU2VjdXJpdHkgQ2hlY2snLCBwZXJjZW50YWdlOiAwLjMgfSxcclxuICAgICAgeyBpZDogJ3dhaXRpbmcnLCBuYW1lOiAnV2FpdGluZyBBcmVhJywgcGVyY2VudGFnZTogMC4zIH1cclxuICAgIF1cclxuICB9LFxyXG4gICdUZW50IENpdHkgU2VjdGlvbiBBJzoge1xyXG4gICAgYXJlYUluU3F1YXJlTWV0ZXJzOiAxMjAwMDAsXHJcbiAgICBjYXBhY2l0eTogODAwMDAsIC8vIEFkanVzdGVkIGZvciBwaWxncmltcyBjb3VudFxyXG4gICAgc2VjdGlvbnM6IFtcclxuICAgICAgeyBpZDogJ2ExJywgbmFtZTogJ0Jsb2NrIEExJywgcGVyY2VudGFnZTogMC4yNSB9LFxyXG4gICAgICB7IGlkOiAnYTInLCBuYW1lOiAnQmxvY2sgQTInLCBwZXJjZW50YWdlOiAwLjI1IH0sXHJcbiAgICAgIHsgaWQ6ICdhMycsIG5hbWU6ICdCbG9jayBBMycsIHBlcmNlbnRhZ2U6IDAuMjUgfSxcclxuICAgICAgeyBpZDogJ2E0JywgbmFtZTogJ0Jsb2NrIEE0JywgcGVyY2VudGFnZTogMC4yNSB9XHJcbiAgICBdXHJcbiAgfSxcclxuICAnSmFtYXJhdCBDZW50cmFsIEFjY2Vzcyc6IHtcclxuICAgIGFyZWFJblNxdWFyZU1ldGVyczogODAwMCxcclxuICAgIGNhcGFjaXR5OiAzMDAwMCwgLy8gSG91cmx5IGNhcGFjaXR5XHJcbiAgICBzZWN0aW9uczogW1xyXG4gICAgICB7IGlkOiAnZW50cnknLCBuYW1lOiAnRW50cnkgWm9uZScsIHBlcmNlbnRhZ2U6IDAuNCB9LFxyXG4gICAgICB7IGlkOiAnY29ycmlkb3InLCBuYW1lOiAnTWFpbiBDb3JyaWRvcicsIHBlcmNlbnRhZ2U6IDAuNCB9LFxyXG4gICAgICB7IGlkOiAnZXhpdCcsIG5hbWU6ICdFeGl0IFpvbmUnLCBwZXJjZW50YWdlOiAwLjIgfVxyXG4gICAgXVxyXG4gIH0sXHJcbn07XHJcblxyXG4vLyBDYWxjdWxhdGUgdGhlIHN1bSBvZiBhbGwgbG9jYXRpb24gY2FwYWNpdGllcyB0byB2ZXJpZnkgYWdhaW5zdCB0b3RhbCBwaWxncmltc1xyXG5jb25zdCBUT1RBTF9DQVBBQ0lUWSA9IE9iamVjdC52YWx1ZXMoTE9DQVRJT05fU0laRVMpLnJlZHVjZShcclxuICAoc3VtLCBsb2NhdGlvbikgPT4gc3VtICsgbG9jYXRpb24uY2FwYWNpdHksIFxyXG4gIDBcclxuKTtcclxuXHJcbi8vIERlZmluZSBkZW5zaXR5IHRocmVzaG9sZCBsZXZlbHMgKHBlb3BsZSBwZXIgc3F1YXJlIG1ldGVyKVxyXG4vLyBBZGp1c3RlZCBmb3IgdGhlIHBpbGdyaW1zIGNvdW50IG9mIDI1MCwwMDAtMzUwLDAwMFxyXG5jb25zdCBERU5TSVRZX1RIUkVTSE9MRFMgPSB7XHJcbiAgbG93OiAwLjMsIC8vIDAtMC4zIHBlb3BsZSBwZXIgc3F1YXJlIG1ldGVyIC0gY29tZm9ydGFibGUgbW92ZW1lbnRcclxuICBtZWRpdW06IDAuOCwgLy8gMC4zLTAuOCBwZW9wbGUgcGVyIHNxdWFyZSBtZXRlciAtIG1vZGVyYXRlIGRlbnNpdHlcclxuICBoaWdoOiAxLjUsIC8vIDAuOC0xLjUgcGVvcGxlIHBlciBzcXVhcmUgbWV0ZXIgLSBoaWdoIGRlbnNpdHkgYnV0IG1hbmFnZWFibGVcclxuICAvLyBBYm92ZSAxLjUgaXMgY29uc2lkZXJlZCBjcml0aWNhbCAtIGRpZmZpY3VsdCBtb3ZlbWVudFxyXG59O1xyXG5cclxuLy8gVGltZS1iYXNlZCBtb2RpZmllcnMgZm9yIHZhcmlvdXMgSGFqaiBwZXJpb2RzIC0gaW5jcmVhc2UvZGVjcmVhc2UgbXVsdGlwbGllclxyXG5jb25zdCBUSU1FX01PRElGSUVSUyA9IHtcclxuICBiZWZvcmVQcmF5ZXI6IDIuMCwgLy8gQmVmb3JlIHByYXllciB0aW1lc1xyXG4gIGR1cmluZ1ByYXllcjogMi41LCAvLyBEdXJpbmcgcHJheWVyIHRpbWVzIGluIE1hc2ppZCBhbC1IYXJhbVxyXG4gIGFmdGVyUHJheWVyOiAxLjgsIC8vIEFmdGVyIHByYXllciBkaXNwZXJzYWxcclxuICBqYW1hcmF0OiAzLjAsIC8vIER1cmluZyBzdG9uaW5nIHJpdHVhbCB0aW1lc1xyXG4gIHRhd2FmOiAyLjUsIC8vIER1cmluZyBwZWFrIFRhd2FmIGhvdXJzXHJcbiAgc2F5ZWU6IDIuMCwgLy8gRHVyaW5nIHBlYWsgU2EnZWUgaG91cnNcclxuICBuaWdodDogMC43LCAvLyBMYXRlIG5pZ2h0IGhvdXJzXHJcbiAgZWFybHlNb3JuaW5nOiAwLjgsIC8vIEVhcmx5IG1vcm5pbmcgaG91cnNcclxuICBoYWpqRGF5OiAzLjAsIC8vIE1haW4gSGFqaiBkYXkgYXQgQXJhZmF0XHJcbn07XHJcblxyXG4vLyBXZWF0aGVyIGltcGFjdHMgb24gY3Jvd2QgYmVoYXZpb3JcclxuY29uc3QgV0VBVEhFUl9NT0RJRklFUlMgPSB7XHJcbiAgaG90OiAwLjksIC8vIFZlcnkgaG90IHdlYXRoZXIgcmVkdWNlcyBvdXRkb29yIGRlbnNpdGllc1xyXG4gIHJhaW46IDAuNywgLy8gUmFpbiByZWR1Y2VzIG91dGRvb3IgZGVuc2l0aWVzIFxyXG4gIHBsZWFzYW50OiAxLjIsIC8vIFBsZWFzYW50IHdlYXRoZXIgaW5jcmVhc2VzIG1vdmVtZW50XHJcbn07XHJcblxyXG4vLyBGdW5jdGlvbiB0byBnZXQgcmVhbGlzdGljIGNyb3dkIGRlbnNpdGllcyBiYXNlZCBvbiB2YXJpb3VzIGZhY3RvcnNcclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNhbGN1bGF0ZVJlYWxpc3RpY0Nyb3dkRGVuc2l0aWVzKCkge1xyXG4gIGNvbnN0IG5vdyA9IG5ldyBEYXRlKCk7XHJcbiAgY29uc3QgaG91ciA9IG5vdy5nZXRIb3VycygpO1xyXG4gIGNvbnN0IGxvY2F0aW9ucyA9IE9iamVjdC5rZXlzKExPQ0FUSU9OX1NJWkVTKTtcclxuICBcclxuICAvLyBEZXRlcm1pbmUgY3VycmVudCBmYWN0b3JzIGFmZmVjdGluZyBkZW5zaXR5XHJcbiAgbGV0IHRpbWVNb2RpZmllciA9IDEuMDtcclxuICBcclxuICAvLyBUaW1lIG9mIGRheSBhZGp1c3RtZW50c1xyXG4gIGlmIChob3VyID49IDIyIHx8IGhvdXIgPCA0KSB7XHJcbiAgICB0aW1lTW9kaWZpZXIgPSBUSU1FX01PRElGSUVSUy5uaWdodDtcclxuICB9IGVsc2UgaWYgKGhvdXIgPj0gNCAmJiBob3VyIDwgNikge1xyXG4gICAgdGltZU1vZGlmaWVyID0gVElNRV9NT0RJRklFUlMuZWFybHlNb3JuaW5nO1xyXG4gIH0gZWxzZSBpZiAoWzUsIDEyLCAxNSwgMTgsIDIwXS5pbmNsdWRlcyhob3VyKSkge1xyXG4gICAgLy8gUHJheWVyIHRpbWVzXHJcbiAgICB0aW1lTW9kaWZpZXIgPSBUSU1FX01PRElGSUVSUy5kdXJpbmdQcmF5ZXI7XHJcbiAgfSBlbHNlIGlmIChbNiwgMTMsIDE2LCAxOSwgMjFdLmluY2x1ZGVzKGhvdXIpKSB7XHJcbiAgICAvLyBBZnRlciBwcmF5ZXJcclxuICAgIHRpbWVNb2RpZmllciA9IFRJTUVfTU9ESUZJRVJTLmFmdGVyUHJheWVyO1xyXG4gIH0gZWxzZSBpZiAoWzQsIDExLCAxNCwgMTcsIDE5XS5pbmNsdWRlcyhob3VyKSkge1xyXG4gICAgLy8gQmVmb3JlIHByYXllclxyXG4gICAgdGltZU1vZGlmaWVyID0gVElNRV9NT0RJRklFUlMuYmVmb3JlUHJheWVyO1xyXG4gIH1cclxuICBcclxuICAvLyBTcGVjaWFsIHRpbWUgYWRqdXN0bWVudHMgZm9yIHNwZWNpZmljIGxvY2F0aW9uc1xyXG4gIGNvbnN0IGphbWFyYXRfaG91cnMgPSBbNiwgNywgOCwgMTMsIDE0LCAxNSwgMTZdO1xyXG4gIGNvbnN0IHRhd2FmX2hvdXJzID0gWzUsIDYsIDcsIDIxLCAyMiwgMjNdO1xyXG4gIFxyXG4gIC8vIEhhamogZGF5IHNpbXVsYXRpb24gKGJhc2VkIG9uIG1vbnRoL2RheS9ob3VyKVxyXG4gIC8vIEZvciBkZW1vIHB1cnBvc2VzLCB3ZSdsbCBzaW11bGF0ZSBvbmUgZGF5IG9mIHRoZSB3ZWVrIGFzIEhhamogZGF5XHJcbiAgY29uc3QgaXNIYWpqRGF5ID0gbm93LmdldERheSgpID09PSA1OyAvLyBGcmlkYXkgZm9yIGRlbW8gcHVycG9zZXNcclxuICBcclxuICAvLyBGb3IgZGVtbyBwdXJwb3NlcywgZm9yY2UgXCJIYWpqIGRheVwiIGJlaGF2aW9yIHdoZW4gbWludXRlcyBhcmUgZGl2aXNpYmxlIGJ5IDNcclxuICBjb25zdCBmb3JjZWRIYWpqRGF5ID0gbm93LmdldE1pbnV0ZXMoKSAlIDMgPT09IDA7XHJcbiAgXHJcbiAgLy8gV2VhdGhlciBzaW11bGF0aW9uIChzaW1wbGlmaWVkKVxyXG4gIC8vIEZvciBkZW1vLCB3ZSdsbCBiYXNlIGl0IG9uIHRpbWUgb2YgZGF5IGluIE1lY2NhIHdoaWNoIGlzIHR5cGljYWxseSBob3QgbWlkZGF5XHJcbiAgbGV0IHdlYXRoZXJNb2RpZmllciA9IDEuMDtcclxuICBpZiAoaG91ciA+PSAxMSAmJiBob3VyIDw9IDE1KSB7XHJcbiAgICB3ZWF0aGVyTW9kaWZpZXIgPSBXRUFUSEVSX01PRElGSUVSUy5ob3Q7XHJcbiAgfSBlbHNlIGlmIChob3VyID49IDE2ICYmIGhvdXIgPD0gMTgpIHtcclxuICAgIHdlYXRoZXJNb2RpZmllciA9IFdFQVRIRVJfTU9ESUZJRVJTLnBsZWFzYW50O1xyXG4gIH1cclxuICBcclxuICAvLyBEZXRlcm1pbmUgY3VycmVudCB0b3RhbCBwaWxncmltIGNvdW50IC0gdmFyaWVzIHdpdGhpbiB0aGUgcmFuZ2VcclxuICAvLyBVc2UgbWludXRlIG9mIHRoZSBob3VyIHRvIGNyZWF0ZSBzb21lIG5hdHVyYWwgdmFyaWF0aW9uXHJcbiAgY29uc3QgcGlsZ3JpbVZhcmlhdGlvbiA9IChub3cuZ2V0TWludXRlcygpIC8gNjApICogKFRPVEFMX1BJTEdSSU1TX01BWCAtIFRPVEFMX1BJTEdSSU1TX01JTik7XHJcbiAgY29uc3QgY3VycmVudFRvdGFsUGlsZ3JpbXMgPSBUT1RBTF9QSUxHUklNU19NSU4gKyBNYXRoLmZsb29yKHBpbGdyaW1WYXJpYXRpb24pO1xyXG4gIFxyXG4gIC8vIEdlbmVyYXRlIHJlYWxpc3RpYyBjcm93ZCBkZW5zaXR5IGZvciBlYWNoIGxvY2F0aW9uXHJcbiAgY29uc3QgZGVuc2l0eURhdGEgPSBsb2NhdGlvbnMubWFwKChsb2NhdGlvbk5hbWUsIGluZGV4KSA9PiB7XHJcbiAgICBjb25zdCBsb2NhdGlvbkRhdGEgPSBMT0NBVElPTl9TSVpFU1tsb2NhdGlvbk5hbWVdO1xyXG4gICAgXHJcbiAgICAvLyBBcHBseSBsb2NhdGlvbi1zcGVjaWZpYyBtb2RpZmllcnNcclxuICAgIGxldCBsb2NhdGlvblRpbWVNb2RpZmllciA9IHRpbWVNb2RpZmllcjtcclxuICAgIFxyXG4gICAgaWYgKGxvY2F0aW9uTmFtZSA9PT0gJ0phbWFyYWF0IEJyaWRnZScgJiYgamFtYXJhdF9ob3Vycy5pbmNsdWRlcyhob3VyKSkge1xyXG4gICAgICBsb2NhdGlvblRpbWVNb2RpZmllciA9IFRJTUVfTU9ESUZJRVJTLmphbWFyYXQ7XHJcbiAgICB9IGVsc2UgaWYgKGxvY2F0aW9uTmFtZSA9PT0gJ01hc2ppZCBhbC1IYXJhbScgJiYgdGF3YWZfaG91cnMuaW5jbHVkZXMoaG91cikpIHtcclxuICAgICAgbG9jYXRpb25UaW1lTW9kaWZpZXIgPSBUSU1FX01PRElGSUVSUy50YXdhZjtcclxuICAgIH0gZWxzZSBpZiAobG9jYXRpb25OYW1lID09PSAnQXJhZmF0JyAmJiAoaXNIYWpqRGF5IHx8IGZvcmNlZEhhampEYXkpKSB7XHJcbiAgICAgIGxvY2F0aW9uVGltZU1vZGlmaWVyID0gVElNRV9NT0RJRklFUlMuaGFqakRheTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgLy8gVXNlIGRldGVybWluaXN0aWMgY2FsY3VsYXRpb25zIGZvciBkZW5zaXR5IGJhc2VkIG9uIGxvY2F0aW9uIGFuZCB0aW1lXHJcbiAgICAvLyBpbnN0ZWFkIG9mIGZ1bGx5IHJhbmRvbSB0byBlbnN1cmUgY29uc2lzdGVudCBwYXR0ZXJuc1xyXG4gICAgbGV0IGJhc2VPY2N1cGFuY3lQZXJjZW50YWdlO1xyXG4gICAgXHJcbiAgICAvLyBDYWxjdWxhdGUgbG9jYXRpb24ncyBwb3J0aW9uIG9mIHRvdGFsIHBpbGdyaW1zXHJcbiAgICBjb25zdCBsb2NhdGlvbkNhcGFjaXR5UmF0aW8gPSBsb2NhdGlvbkRhdGEuY2FwYWNpdHkgLyBUT1RBTF9DQVBBQ0lUWTtcclxuICAgIGNvbnN0IGJhc2VFeHBlY3RlZFBpbGdyaW1zID0gY3VycmVudFRvdGFsUGlsZ3JpbXMgKiBsb2NhdGlvbkNhcGFjaXR5UmF0aW87XHJcbiAgICBcclxuICAgIC8vIEVhY2ggbG9jYXRpb24gaGFzIGRpZmZlcmVudCBiYXNlbGluZSBjcm93ZCBwYXR0ZXJuc1xyXG4gICAgc3dpdGNoIChsb2NhdGlvbk5hbWUpIHtcclxuICAgICAgY2FzZSAnTWFzamlkIGFsLUhhcmFtJzpcclxuICAgICAgICAvLyBNYXNqaWQgYWwtSGFyYW0gaXMgY29uc2lzdGVudGx5IGJ1c2llclxyXG4gICAgICAgIGJhc2VPY2N1cGFuY3lQZXJjZW50YWdlID0gMC43ICsgKGhvdXIgJSAzKSAqIDAuMTtcclxuICAgICAgICBicmVhaztcclxuICAgICAgY2FzZSAnSmFtYXJhYXQgQnJpZGdlJzpcclxuICAgICAgICAvLyBKYW1hcmF0IGlzIGV4dHJlbWVseSBidXN5IGR1cmluZyBzcGVjaWZpYyBob3Vyc1xyXG4gICAgICAgIGlmIChqYW1hcmF0X2hvdXJzLmluY2x1ZGVzKGhvdXIpKSB7XHJcbiAgICAgICAgICBiYXNlT2NjdXBhbmN5UGVyY2VudGFnZSA9IDAuOTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgYmFzZU9jY3VwYW5jeVBlcmNlbnRhZ2UgPSAwLjU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgICBjYXNlICdNaW5hJzpcclxuICAgICAgICAvLyBNaW5hIHZhcmllcyBzaWduaWZpY2FudGx5IGJ5IGRheVxyXG4gICAgICAgIGJhc2VPY2N1cGFuY3lQZXJjZW50YWdlID0gKGlzSGFqakRheSB8fCBmb3JjZWRIYWpqRGF5KSA/IDAuOTUgOiAwLjY7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICAgIGNhc2UgJ0FyYWZhdCc6XHJcbiAgICAgICAgLy8gQXJhZmF0IGlzIGV4dHJlbWVseSBidXN5IG9uIEhhamogZGF5LCBlbXB0eSBvdGhlcndpc2VcclxuICAgICAgICBiYXNlT2NjdXBhbmN5UGVyY2VudGFnZSA9IChpc0hhampEYXkgfHwgZm9yY2VkSGFqakRheSkgPyAwLjk4IDogMC4zO1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgICBjYXNlICdNdXpkYWxpZmFoJzpcclxuICAgICAgICAvLyBNdXpkYWxpZmFoIGlzIGJ1c3kgaW4gdGhlIGV2ZW5pbmdcclxuICAgICAgICBiYXNlT2NjdXBhbmN5UGVyY2VudGFnZSA9IChob3VyID49IDE4ICYmIGhvdXIgPD0gMjMpID8gMC44NSA6IDAuNDtcclxuICAgICAgICBicmVhaztcclxuICAgICAgZGVmYXVsdDpcclxuICAgICAgICAvLyBVc2UgbWludXRlcy9zZWNvbmRzIGFzIGEgc2VlZCBmb3Igb3RoZXIgbG9jYXRpb25zIHRvIGdldCB2YXJpYXRpb25cclxuICAgICAgICBiYXNlT2NjdXBhbmN5UGVyY2VudGFnZSA9IDAuNCArIChub3cuZ2V0TWludXRlcygpICUgMTApIC8gMTA7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIERFTU86IEZvciBkZW1vbnN0cmF0aW9uIHB1cnBvc2VzLCBlbnN1cmUgd2UgaGF2ZSBhIG1peCBvZiBhbGwgZGVuc2l0eSBsZXZlbHNcclxuICAgIC8vIEZvcmNlIHNvbWUgbG9jYXRpb25zIHRvIHNwZWNpZmljIGRlbnNpdHkgbGV2ZWxzXHJcbiAgICBpZiAoaW5kZXggJSA1ID09PSAwKSB7XHJcbiAgICAgIC8vIEV2ZXJ5IDV0aCBsb2NhdGlvbiAoYnkgb3JkZXIpIGlzIGZvcmNlZCB0byBoaWdoIGRlbnNpdHlcclxuICAgICAgYmFzZU9jY3VwYW5jeVBlcmNlbnRhZ2UgPSAwLjk7XHJcbiAgICAgIGxvY2F0aW9uVGltZU1vZGlmaWVyID0gMi4wO1xyXG4gICAgfSBlbHNlIGlmIChpbmRleCAlIDUgPT09IDEpIHtcclxuICAgICAgLy8gRXZlcnkgNXRoKzEgbG9jYXRpb24gaXMgZm9yY2VkIHRvIG1lZGl1bSBkZW5zaXR5XHJcbiAgICAgIGJhc2VPY2N1cGFuY3lQZXJjZW50YWdlID0gMC43O1xyXG4gICAgICBsb2NhdGlvblRpbWVNb2RpZmllciA9IDEuNTtcclxuICAgIH0gZWxzZSBpZiAoaW5kZXggJSA1ID09PSAyKSB7XHJcbiAgICAgIC8vIEV2ZXJ5IDV0aCsyIGxvY2F0aW9uIGlzIGZvcmNlZCB0byBjcml0aWNhbCBkZW5zaXR5XHJcbiAgICAgIGJhc2VPY2N1cGFuY3lQZXJjZW50YWdlID0gMS4wO1xyXG4gICAgICBsb2NhdGlvblRpbWVNb2RpZmllciA9IDIuNTtcclxuICAgIH0gZWxzZSBpZiAoaW5kZXggJSA1ID09PSAzKSB7XHJcbiAgICAgIC8vIEV2ZXJ5IDV0aCszIGxvY2F0aW9uIGlzIGZvcmNlZCB0byBsb3cgZGVuc2l0eVxyXG4gICAgICBiYXNlT2NjdXBhbmN5UGVyY2VudGFnZSA9IDAuNDtcclxuICAgICAgbG9jYXRpb25UaW1lTW9kaWZpZXIgPSAxLjA7XHJcbiAgICB9XHJcbiAgICAvLyBFdmVyeSA1dGgrNCBsb2NhdGlvbiB1c2VzIHRoZSBuYXR1cmFsIGNhbGN1bGF0aW9uXHJcbiAgICBcclxuICAgIC8vIEFwcGx5IGFsbCBtb2RpZmllcnNcclxuICAgIGNvbnN0IG1vZGlmaWVkT2NjdXBhbmN5ID0gYmFzZU9jY3VwYW5jeVBlcmNlbnRhZ2UgKiBsb2NhdGlvblRpbWVNb2RpZmllciAqIHdlYXRoZXJNb2RpZmllcjtcclxuICAgIFxyXG4gICAgLy8gQWRkIHNsaWdodCByYW5kb21uZXNzICjCsTUlIGluc3RlYWQgb2YgwrExMCUgZm9yIG1vcmUgY29uc2lzdGVuY3kpXHJcbiAgICBjb25zdCBmaW5hbE9jY3VwYW5jeSA9IG1vZGlmaWVkT2NjdXBhbmN5ICogKDAuOTUgKyBNYXRoLnJhbmRvbSgpICogMC4xKTtcclxuICAgIFxyXG4gICAgLy8gQ2FsY3VsYXRlIGFjdHVhbCBjcm93ZCBzaXplIGJhc2VkIG9uIG9jY3VwYW5jeSBwZXJjZW50YWdlIGFuZCBjYXBhY2l0eVxyXG4gICAgY29uc3QgY3Jvd2RTaXplID0gTWF0aC5mbG9vcihmaW5hbE9jY3VwYW5jeSAqIGxvY2F0aW9uRGF0YS5jYXBhY2l0eSk7XHJcbiAgICBcclxuICAgIC8vIENhbGN1bGF0ZSBkZW5zaXR5IChwZW9wbGUgcGVyIHNxdWFyZSBtZXRlcilcclxuICAgIGNvbnN0IGRlbnNpdHkgPSBjcm93ZFNpemUgLyBsb2NhdGlvbkRhdGEuYXJlYUluU3F1YXJlTWV0ZXJzO1xyXG4gICAgXHJcbiAgICAvLyBEZXRlcm1pbmUgZGVuc2l0eSBsZXZlbCBiYXNlZCBvbiB0aHJlc2hvbGRzXHJcbiAgICBsZXQgZGVuc2l0eUxldmVsOiBEZW5zaXR5TGV2ZWw7XHJcbiAgICBpZiAoZGVuc2l0eSA8PSBERU5TSVRZX1RIUkVTSE9MRFMubG93KSB7XHJcbiAgICAgIGRlbnNpdHlMZXZlbCA9ICdsb3cnO1xyXG4gICAgfSBlbHNlIGlmIChkZW5zaXR5IDw9IERFTlNJVFlfVEhSRVNIT0xEUy5tZWRpdW0pIHtcclxuICAgICAgZGVuc2l0eUxldmVsID0gJ21lZGl1bSc7XHJcbiAgICB9IGVsc2UgaWYgKGRlbnNpdHkgPD0gREVOU0lUWV9USFJFU0hPTERTLmhpZ2gpIHtcclxuICAgICAgZGVuc2l0eUxldmVsID0gJ2hpZ2gnO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgZGVuc2l0eUxldmVsID0gJ2NyaXRpY2FsJztcclxuICAgIH1cclxuICAgIFxyXG4gICAgLy8gR2VuZXJhdGUgc2VjdGlvbi1zcGVjaWZpYyBkYXRhXHJcbiAgICBjb25zdCBzZWN0aW9uRGF0YSA9IGxvY2F0aW9uRGF0YS5zZWN0aW9ucy5tYXAoKHNlY3Rpb246IExvY2F0aW9uU2VjdGlvbikgPT4ge1xyXG4gICAgICAvLyBFYWNoIHNlY3Rpb24gaGFzIHNsaWdodGx5IGRpZmZlcmVudCBvY2N1cGFuY3lcclxuICAgICAgY29uc3Qgc2VjdGlvblZhcmlhdGlvbiA9IDAuOSArIE1hdGgucmFuZG9tKCkgKiAwLjI7IC8vIDkwLTExMCUgb2YgbG9jYXRpb24gYXZlcmFnZVxyXG4gICAgICBjb25zdCBzZWN0aW9uRGVuc2l0eSA9IGRlbnNpdHkgKiBzZWN0aW9uVmFyaWF0aW9uO1xyXG4gICAgICBcclxuICAgICAgLy8gRGV0ZXJtaW5lIHNlY3Rpb24gZGVuc2l0eSBsZXZlbFxyXG4gICAgICBsZXQgc2VjdGlvbkRlbnNpdHlMZXZlbDogRGVuc2l0eUxldmVsO1xyXG4gICAgICBpZiAoc2VjdGlvbkRlbnNpdHkgPD0gREVOU0lUWV9USFJFU0hPTERTLmxvdykge1xyXG4gICAgICAgIHNlY3Rpb25EZW5zaXR5TGV2ZWwgPSAnbG93JztcclxuICAgICAgfSBlbHNlIGlmIChzZWN0aW9uRGVuc2l0eSA8PSBERU5TSVRZX1RIUkVTSE9MRFMubWVkaXVtKSB7XHJcbiAgICAgICAgc2VjdGlvbkRlbnNpdHlMZXZlbCA9ICdtZWRpdW0nO1xyXG4gICAgICB9IGVsc2UgaWYgKHNlY3Rpb25EZW5zaXR5IDw9IERFTlNJVFlfVEhSRVNIT0xEUy5oaWdoKSB7XHJcbiAgICAgICAgc2VjdGlvbkRlbnNpdHlMZXZlbCA9ICdoaWdoJztcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBzZWN0aW9uRGVuc2l0eUxldmVsID0gJ2NyaXRpY2FsJztcclxuICAgICAgfVxyXG4gICAgICBcclxuICAgICAgcmV0dXJuIHtcclxuICAgICAgICBpZDogc2VjdGlvbi5pZCxcclxuICAgICAgICBuYW1lOiBzZWN0aW9uLm5hbWUsXHJcbiAgICAgICAgZGVuc2l0eTogc2VjdGlvbkRlbnNpdHkudG9GaXhlZCgyKSxcclxuICAgICAgICBkZW5zaXR5X2xldmVsOiBzZWN0aW9uRGVuc2l0eUxldmVsLFxyXG4gICAgICAgIGNyb3dkX3NpemU6IE1hdGguZmxvb3IoY3Jvd2RTaXplICogc2VjdGlvbi5wZXJjZW50YWdlKSxcclxuICAgICAgfTtcclxuICAgIH0pO1xyXG4gICAgXHJcbiAgICAvLyBBZGQgc29tZSByYW5kb21uZXNzIHRvIHRoZSBleGFjdCBjb29yZGluYXRlcyB0byByZXByZXNlbnQgZGlmZmVyZW50IGFyZWFzXHJcbiAgICBjb25zdCBiYXNlQ29vcmRpbmF0ZXMgPSBnZXRCYXNlQ29vcmRpbmF0ZXMobG9jYXRpb25OYW1lKTtcclxuICAgIGNvbnN0IGNvb3JkaW5hdGVzID0ge1xyXG4gICAgICBsbmc6IGJhc2VDb29yZGluYXRlcy5sbmcgKyAoTWF0aC5yYW5kb20oKSAqIDAuMDAwNSAtIDAuMDAwMjUpLFxyXG4gICAgICBsYXQ6IGJhc2VDb29yZGluYXRlcy5sYXQgKyAoTWF0aC5yYW5kb20oKSAqIDAuMDAwNSAtIDAuMDAwMjUpXHJcbiAgICB9O1xyXG4gICAgXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBsb2NhdGlvbl9uYW1lOiBsb2NhdGlvbk5hbWUsXHJcbiAgICAgIGNvb3JkaW5hdGVzOiBjb29yZGluYXRlcyxcclxuICAgICAgZGVuc2l0eTogZGVuc2l0eS50b0ZpeGVkKDIpLFxyXG4gICAgICBkZW5zaXR5X2xldmVsOiBkZW5zaXR5TGV2ZWwsXHJcbiAgICAgIGNyb3dkX3NpemU6IGNyb3dkU2l6ZSxcclxuICAgICAgY2FwYWNpdHk6IGxvY2F0aW9uRGF0YS5jYXBhY2l0eSxcclxuICAgICAgb2NjdXBhbmN5X3BlcmNlbnRhZ2U6IChmaW5hbE9jY3VwYW5jeSAqIDEwMCkudG9GaXhlZCgxKSxcclxuICAgICAgc2VjdGlvbnM6IHNlY3Rpb25EYXRhLFxyXG4gICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcclxuICAgICAgbWV0YV9kYXRhOiB7XHJcbiAgICAgICAgZGVuc2l0eTogcGFyc2VGbG9hdChkZW5zaXR5LnRvRml4ZWQoMikpLFxyXG4gICAgICAgIGNhcGFjaXR5OiBsb2NhdGlvbkRhdGEuY2FwYWNpdHksXHJcbiAgICAgICAgc2VjdGlvbnM6IHNlY3Rpb25EYXRhLFxyXG4gICAgICAgIGN1cnJlbnRfdG90YWxfcGlsZ3JpbXM6IGN1cnJlbnRUb3RhbFBpbGdyaW1zXHJcbiAgICAgIH1cclxuICAgIH07XHJcbiAgfSk7XHJcbiAgXHJcbiAgLy8gRGVidWcgaW5mb3JtYXRpb24gYWJvdXQgdG90YWwgcGlsZ3JpbSBkaXN0cmlidXRpb25cclxuICBjb25zdCB0b3RhbENyb3dkU2l6ZSA9IGRlbnNpdHlEYXRhLnJlZHVjZSgoc3VtLCBsb2NhdGlvbikgPT4gc3VtICsgbG9jYXRpb24uY3Jvd2Rfc2l6ZSwgMCk7XHJcbiAgY29uc29sZS5sb2coYFRvdGFsIHBpbGdyaW1zIGN1cnJlbnRseSBkaXN0cmlidXRlZDogJHt0b3RhbENyb3dkU2l6ZX0gKHRhcmdldDogJHtjdXJyZW50VG90YWxQaWxncmltc30pYCk7XHJcbiAgXHJcbiAgcmV0dXJuIGRlbnNpdHlEYXRhO1xyXG59XHJcblxyXG4vLyBGdW5jdGlvbiB0byB1cGRhdGUgZGF0YWJhc2Ugd2l0aCBjYWxjdWxhdGVkIGRlbnNpdHlcclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZUNyb3dkRGVuc2l0eURhdGEoKSB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnNvbGUubG9nKCdTdGFydGluZyB1cGRhdGVDcm93ZERlbnNpdHlEYXRhJyk7XHJcbiAgICBjb25zdCBkZW5zaXR5RGF0YSA9IGF3YWl0IGNhbGN1bGF0ZVJlYWxpc3RpY0Nyb3dkRGVuc2l0aWVzKCk7XHJcbiAgICBjb25zb2xlLmxvZyhgR2VuZXJhdGVkICR7ZGVuc2l0eURhdGEubGVuZ3RofSBkZW5zaXR5IGRhdGEgcG9pbnRzYCk7XHJcbiAgICBcclxuICAgIC8vIExvZyBkZW5zaXR5IGxldmVscyBmb3IgZGVidWdnaW5nXHJcbiAgICBjb25zb2xlLmxvZygnQ3VycmVudCBkZW5zaXR5IGxldmVsczonKTtcclxuICAgIGRlbnNpdHlEYXRhLmZvckVhY2gobG9jYXRpb24gPT4ge1xyXG4gICAgICBjb25zb2xlLmxvZyhgJHtsb2NhdGlvbi5sb2NhdGlvbl9uYW1lfTogJHtsb2NhdGlvbi5kZW5zaXR5X2xldmVsfSAoJHtsb2NhdGlvbi5kZW5zaXR5fSlgKTtcclxuICAgIH0pO1xyXG4gICAgXHJcbiAgICBpZiAoIXN1cGFiYXNlQWRtaW4pIHtcclxuICAgICAgY29uc29sZS5sb2coJ1N1cGFiYXNlIGFkbWluIGNsaWVudCBub3QgYXZhaWxhYmxlLCByZXR1cm5pbmcgY2FsY3VsYXRlZCBkYXRhIGRpcmVjdGx5Jyk7XHJcbiAgICAgIHJldHVybiB7IFxyXG4gICAgICAgIHN1Y2Nlc3M6IHRydWUsIFxyXG4gICAgICAgIGNvdW50OiBkZW5zaXR5RGF0YS5sZW5ndGgsIFxyXG4gICAgICAgIGRhdGE6IGRlbnNpdHlEYXRhLFxyXG4gICAgICAgIG1lc3NhZ2U6ICdEYXRhYmFzZSBjb25uZWN0aW9uIG5vdCBhdmFpbGFibGUsIHVzaW5nIGNhbGN1bGF0ZWQgZGF0YScgXHJcbiAgICAgIH07XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIENsZWFyIGV4aXN0aW5nIGRhdGEgYW5kIGluc2VydCBuZXcgZGF0YVxyXG4gICAgdHJ5IHtcclxuICAgICAgY29uc29sZS5sb2coJ0F0dGVtcHRpbmcgdG8gY2xlYXIgZXhpc3RpbmcgZGF0YScpO1xyXG4gICAgICBjb25zdCB7IGVycm9yOiBkZWxldGVFcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VBZG1pblxyXG4gICAgICAgIC5mcm9tKCdjcm93ZF9kZW5zaXR5JylcclxuICAgICAgICAuZGVsZXRlKClcclxuICAgICAgICAubmVxKCdpZCcsIDApOyAvLyBEZWxldGUgYWxsIHJlY29yZHNcclxuICAgICAgXHJcbiAgICAgIGlmIChkZWxldGVFcnJvcikge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNsZWFyaW5nIGV4aXN0aW5nIGRhdGE6JywgZGVsZXRlRXJyb3IpO1xyXG4gICAgICAgIHJldHVybiB7IFxyXG4gICAgICAgICAgc3VjY2VzczogdHJ1ZSwgLy8gU3RpbGwgcmV0dXJuIHN1Y2Nlc3Mgd2l0aCB0aGUgY2FsY3VsYXRlZCBkYXRhXHJcbiAgICAgICAgICBlcnJvcjogZGVsZXRlRXJyb3IsIFxyXG4gICAgICAgICAgZGF0YTogZGVuc2l0eURhdGEsXHJcbiAgICAgICAgICBjb3VudDogZGVuc2l0eURhdGEubGVuZ3RoLFxyXG4gICAgICAgICAgbWVzc2FnZTogJ0ZhaWxlZCB0byBjbGVhciBleGlzdGluZyBkYXRhLCBidXQgcmV0dXJuaW5nIGNhbGN1bGF0ZWQgZGF0YSdcclxuICAgICAgICB9O1xyXG4gICAgICB9XHJcbiAgICAgIFxyXG4gICAgICAvLyBJbnNlcnQgbmV3IGRhdGFcclxuICAgICAgY29uc29sZS5sb2coJ1ByZXBhcmluZyBkYXRhIGZvciBpbnNlcnRpb24nKTtcclxuICAgICAgY29uc3QgdXBzZXJ0RGF0YSA9IGRlbnNpdHlEYXRhLm1hcChsb2NhdGlvbiA9PiAoe1xyXG4gICAgICAgIGxvY2F0aW9uX25hbWU6IGxvY2F0aW9uLmxvY2F0aW9uX25hbWUsXHJcbiAgICAgICAgY29vcmRpbmF0ZXM6IGxvY2F0aW9uLmNvb3JkaW5hdGVzLFxyXG4gICAgICAgIGRlbnNpdHlfbGV2ZWw6IGxvY2F0aW9uLmRlbnNpdHlfbGV2ZWwsXHJcbiAgICAgICAgdXBkYXRlZF9hdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxyXG4gICAgICAgIGNyb3dkX3NpemU6IGxvY2F0aW9uLmNyb3dkX3NpemUsXHJcbiAgICAgICAgb2NjdXBhbmN5X3BlcmNlbnRhZ2U6IGxvY2F0aW9uLm9jY3VwYW5jeV9wZXJjZW50YWdlLFxyXG4gICAgICAgIG1ldGFfZGF0YToge1xyXG4gICAgICAgICAgZGVuc2l0eTogbG9jYXRpb24uZGVuc2l0eSxcclxuICAgICAgICAgIGNhcGFjaXR5OiBsb2NhdGlvbi5jYXBhY2l0eSxcclxuICAgICAgICAgIHNlY3Rpb25zOiBsb2NhdGlvbi5zZWN0aW9ucyxcclxuICAgICAgICAgIGN1cnJlbnRfdG90YWxfcGlsZ3JpbXM6IGxvY2F0aW9uLm1ldGFfZGF0YS5jdXJyZW50X3RvdGFsX3BpbGdyaW1zXHJcbiAgICAgICAgfVxyXG4gICAgICB9KSk7XHJcbiAgICAgIFxyXG4gICAgICBjb25zb2xlLmxvZygnQXR0ZW1wdGluZyB0byBpbnNlcnQgZGF0YSBpbnRvIFN1cGFiYXNlJyk7XHJcbiAgICAgIGNvbnN0IHsgZXJyb3I6IGluc2VydEVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZUFkbWluXHJcbiAgICAgICAgLmZyb20oJ2Nyb3dkX2RlbnNpdHknKVxyXG4gICAgICAgIC5pbnNlcnQodXBzZXJ0RGF0YSk7XHJcbiAgICAgIFxyXG4gICAgICBpZiAoaW5zZXJ0RXJyb3IpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBpbnNlcnRpbmcgY3Jvd2QgZGVuc2l0eSBkYXRhOicsIGluc2VydEVycm9yKTtcclxuICAgICAgICByZXR1cm4geyBcclxuICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsIC8vIFN0aWxsIHJldHVybiBzdWNjZXNzIHdpdGggdGhlIGNhbGN1bGF0ZWQgZGF0YVxyXG4gICAgICAgICAgZXJyb3I6IGluc2VydEVycm9yLCBcclxuICAgICAgICAgIGRhdGE6IGRlbnNpdHlEYXRhLFxyXG4gICAgICAgICAgY291bnQ6IGRlbnNpdHlEYXRhLmxlbmd0aCxcclxuICAgICAgICAgIG1lc3NhZ2U6ICdGYWlsZWQgdG8gaW5zZXJ0IGRhdGEsIGJ1dCByZXR1cm5pbmcgY2FsY3VsYXRlZCBkYXRhJ1xyXG4gICAgICAgIH07XHJcbiAgICAgIH1cclxuICAgICAgXHJcbiAgICAgIGNvbnNvbGUubG9nKCdTdWNjZXNzZnVsbHkgdXBkYXRlZCBjcm93ZCBkZW5zaXR5IGRhdGEnKTtcclxuICAgICAgcmV0dXJuIHsgXHJcbiAgICAgICAgc3VjY2VzczogdHJ1ZSwgXHJcbiAgICAgICAgY291bnQ6IGRlbnNpdHlEYXRhLmxlbmd0aCxcclxuICAgICAgICBkYXRhOiBkZW5zaXR5RGF0YVxyXG4gICAgICB9O1xyXG4gICAgfSBjYXRjaCAoZGJFcnJvcikge1xyXG4gICAgICBjb25zb2xlLmVycm9yKCdEYXRhYmFzZSBvcGVyYXRpb24gZXJyb3I6JywgZGJFcnJvcik7XHJcbiAgICAgIHJldHVybiB7IFxyXG4gICAgICAgIHN1Y2Nlc3M6IHRydWUsIC8vIFN0aWxsIHJldHVybiBzdWNjZXNzIHdpdGggdGhlIGNhbGN1bGF0ZWQgZGF0YVxyXG4gICAgICAgIGVycm9yOiBkYkVycm9yLCBcclxuICAgICAgICBkYXRhOiBkZW5zaXR5RGF0YSxcclxuICAgICAgICBjb3VudDogZGVuc2l0eURhdGEubGVuZ3RoLFxyXG4gICAgICAgIG1lc3NhZ2U6ICdEYXRhYmFzZSBlcnJvciwgYnV0IHJldHVybmluZyBjYWxjdWxhdGVkIGRhdGEnXHJcbiAgICAgIH07XHJcbiAgICB9XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGluIHVwZGF0ZUNyb3dkRGVuc2l0eURhdGE6JywgZXJyb3IpO1xyXG4gICAgLy8gVHJ5IHRvIHJldHVybiBjYWxjdWxhdGVkIGRhdGEgZGlyZWN0bHkgYXMgYSBmYWxsYmFja1xyXG4gICAgdHJ5IHtcclxuICAgICAgY29uc3QgZGlyZWN0RGF0YSA9IGF3YWl0IGNhbGN1bGF0ZVJlYWxpc3RpY0Nyb3dkRGVuc2l0aWVzKCk7XHJcbiAgICAgIHJldHVybiB7IFxyXG4gICAgICAgIHN1Y2Nlc3M6IHRydWUsIFxyXG4gICAgICAgIGVycm9yLCBcclxuICAgICAgICBkYXRhOiBkaXJlY3REYXRhLFxyXG4gICAgICAgIGNvdW50OiBkaXJlY3REYXRhLmxlbmd0aCxcclxuICAgICAgICBtZXNzYWdlOiAnRXJyb3Igb2NjdXJyZWQgYnV0IHJldHVybmluZyBkaXJlY3QgY2FsY3VsYXRpb24nIFxyXG4gICAgICB9O1xyXG4gICAgfSBjYXRjaCAoY2FsY0Vycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCBldmVuIGRpcmVjdCBjYWxjdWxhdGlvbjonLCBjYWxjRXJyb3IpO1xyXG4gICAgICByZXR1cm4geyBlcnJvcjogJ0NvbXBsZXRlIGNhbGN1bGF0aW9uIGZhaWx1cmUnIH07XHJcbiAgICB9XHJcbiAgfVxyXG59XHJcblxyXG4vLyBIZWxwZXIgZnVuY3Rpb24gdG8gZ2V0IGJhc2UgY29vcmRpbmF0ZXMgZm9yIGVhY2ggbG9jYXRpb25cclxuZnVuY3Rpb24gZ2V0QmFzZUNvb3JkaW5hdGVzKGxvY2F0aW9uTmFtZTogc3RyaW5nKTogQ29vcmRpbmF0ZXMge1xyXG4gIGNvbnN0IGNvb3JkaW5hdGVzTWFwOiBSZWNvcmQ8c3RyaW5nLCBDb29yZGluYXRlcz4gPSB7XHJcbiAgICAnTWFzamlkIGFsLUhhcmFtJzogeyBsbmc6IDM5LjgyNjE3NCwgbGF0OiAyMS40MjI0ODcgfSxcclxuICAgICdNaW5hJzogeyBsbmc6IDM5Ljg5Mjk2NiwgbGF0OiAyMS40MTMyNDkgfSxcclxuICAgICdKYW1hcmFhdCBCcmlkZ2UnOiB7IGxuZzogMzkuODczNDg1LCBsYXQ6IDIxLjQyMzY1IH0sXHJcbiAgICAnQXJhZmF0JzogeyBsbmc6IDM5Ljk4NDY4NywgbGF0OiAyMS4zNTU0NjEgfSxcclxuICAgICdNdXpkYWxpZmFoJzogeyBsbmc6IDM5LjkzNjMyMiwgbGF0OiAyMS4zODMwODIgfSxcclxuICAgICdNaW5hIEVudHJhbmNlIEdhdGUgMSc6IHsgbG5nOiAzOS44ODcyMzUsIGxhdDogMjEuNDExODU2IH0sXHJcbiAgICAnVGVudCBDaXR5IFNlY3Rpb24gQSc6IHsgbG5nOiAzOS44ODkxMjQsIGxhdDogMjEuNDE0NTAxIH0sXHJcbiAgICAnSmFtYXJhdCBDZW50cmFsIEFjY2Vzcyc6IHsgbG5nOiAzOS44NzE5NTIsIGxhdDogMjEuNDIzODUwIH1cclxuICB9O1xyXG4gIFxyXG4gIHJldHVybiBjb29yZGluYXRlc01hcFtsb2NhdGlvbk5hbWVdIHx8IHsgbG5nOiAzOS44MjYxNzQsIGxhdDogMjEuNDIyNDg3IH07XHJcbn0gIl0sIm5hbWVzIjpbInN1cGFiYXNlQWRtaW4iLCJUT1RBTF9QSUxHUklNU19NSU4iLCJUT1RBTF9QSUxHUklNU19NQVgiLCJUT1RBTF9QSUxHUklNU19BVkciLCJNYXRoIiwiZmxvb3IiLCJMT0NBVElPTl9TSVpFUyIsImFyZWFJblNxdWFyZU1ldGVycyIsImNhcGFjaXR5Iiwic2VjdGlvbnMiLCJpZCIsIm5hbWUiLCJwZXJjZW50YWdlIiwiVE9UQUxfQ0FQQUNJVFkiLCJPYmplY3QiLCJ2YWx1ZXMiLCJyZWR1Y2UiLCJzdW0iLCJsb2NhdGlvbiIsIkRFTlNJVFlfVEhSRVNIT0xEUyIsImxvdyIsIm1lZGl1bSIsImhpZ2giLCJUSU1FX01PRElGSUVSUyIsImJlZm9yZVByYXllciIsImR1cmluZ1ByYXllciIsImFmdGVyUHJheWVyIiwiamFtYXJhdCIsInRhd2FmIiwic2F5ZWUiLCJuaWdodCIsImVhcmx5TW9ybmluZyIsImhhampEYXkiLCJXRUFUSEVSX01PRElGSUVSUyIsImhvdCIsInJhaW4iLCJwbGVhc2FudCIsImNhbGN1bGF0ZVJlYWxpc3RpY0Nyb3dkRGVuc2l0aWVzIiwibm93IiwiRGF0ZSIsImhvdXIiLCJnZXRIb3VycyIsImxvY2F0aW9ucyIsImtleXMiLCJ0aW1lTW9kaWZpZXIiLCJpbmNsdWRlcyIsImphbWFyYXRfaG91cnMiLCJ0YXdhZl9ob3VycyIsImlzSGFqakRheSIsImdldERheSIsImZvcmNlZEhhampEYXkiLCJnZXRNaW51dGVzIiwid2VhdGhlck1vZGlmaWVyIiwicGlsZ3JpbVZhcmlhdGlvbiIsImN1cnJlbnRUb3RhbFBpbGdyaW1zIiwiZGVuc2l0eURhdGEiLCJtYXAiLCJsb2NhdGlvbk5hbWUiLCJpbmRleCIsImxvY2F0aW9uRGF0YSIsImxvY2F0aW9uVGltZU1vZGlmaWVyIiwiYmFzZU9jY3VwYW5jeVBlcmNlbnRhZ2UiLCJsb2NhdGlvbkNhcGFjaXR5UmF0aW8iLCJiYXNlRXhwZWN0ZWRQaWxncmltcyIsIm1vZGlmaWVkT2NjdXBhbmN5IiwiZmluYWxPY2N1cGFuY3kiLCJyYW5kb20iLCJjcm93ZFNpemUiLCJkZW5zaXR5IiwiZGVuc2l0eUxldmVsIiwic2VjdGlvbkRhdGEiLCJzZWN0aW9uIiwic2VjdGlvblZhcmlhdGlvbiIsInNlY3Rpb25EZW5zaXR5Iiwic2VjdGlvbkRlbnNpdHlMZXZlbCIsInRvRml4ZWQiLCJkZW5zaXR5X2xldmVsIiwiY3Jvd2Rfc2l6ZSIsImJhc2VDb29yZGluYXRlcyIsImdldEJhc2VDb29yZGluYXRlcyIsImNvb3JkaW5hdGVzIiwibG5nIiwibGF0IiwibG9jYXRpb25fbmFtZSIsIm9jY3VwYW5jeV9wZXJjZW50YWdlIiwidGltZXN0YW1wIiwidG9JU09TdHJpbmciLCJtZXRhX2RhdGEiLCJwYXJzZUZsb2F0IiwiY3VycmVudF90b3RhbF9waWxncmltcyIsInRvdGFsQ3Jvd2RTaXplIiwiY29uc29sZSIsImxvZyIsInVwZGF0ZUNyb3dkRGVuc2l0eURhdGEiLCJsZW5ndGgiLCJmb3JFYWNoIiwic3VjY2VzcyIsImNvdW50IiwiZGF0YSIsIm1lc3NhZ2UiLCJlcnJvciIsImRlbGV0ZUVycm9yIiwiZnJvbSIsImRlbGV0ZSIsIm5lcSIsInVwc2VydERhdGEiLCJ1cGRhdGVkX2F0IiwiaW5zZXJ0RXJyb3IiLCJpbnNlcnQiLCJkYkVycm9yIiwiZGlyZWN0RGF0YSIsImNhbGNFcnJvciIsImNvb3JkaW5hdGVzTWFwIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/crowdSensors.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/supabase.ts":
/*!*****************************!*\
  !*** ./src/lib/supabase.ts ***!
  \*****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   fetchCrowdDensity: () => (/* binding */ fetchCrowdDensity),\n/* harmony export */   fetchSafetyAlerts: () => (/* binding */ fetchSafetyAlerts),\n/* harmony export */   getOptimalRoute: () => (/* binding */ getOptimalRoute),\n/* harmony export */   subscribeToCrowdDensity: () => (/* binding */ subscribeToCrowdDensity),\n/* harmony export */   supabase: () => (/* binding */ supabase),\n/* harmony export */   supabaseAdmin: () => (/* binding */ supabaseAdmin)\n/* harmony export */ });\n/* harmony import */ var _supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @supabase/supabase-js */ \"(rsc)/./node_modules/@supabase/supabase-js/dist/module/index.js\");\n\n// Environment variables\nconst supabaseUrl = \"https://uowkmsvtqrsyblobsazw.supabase.co/\" || 0;\nconst supabaseAnonKey = \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InVvd2ttc3Z0cXJzeWJsb2JzYXp3Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDU0Mzc2NTgsImV4cCI6MjA2MTAxMzY1OH0.EBQ3Pn9yvN2L6G5HTe5c10bGOF8xs28jQ-plE1g8HOc\" || 0;\nconst supabaseServiceKey = process.env.SUPABASE_SERVICE_ROLE_KEY || \"\";\n// Client for client-side and authenticated requests\n// Ensure we have a valid key\nconst supabase = (0,_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__.createClient)(supabaseUrl, supabaseAnonKey);\n// Service role client for server-side operations (only used in server components or API routes)\n// Only create if we have a valid service key\nconst supabaseAdmin = supabaseServiceKey && supabaseServiceKey.length > 0 ? (0,_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__.createClient)(supabaseUrl, supabaseServiceKey, {\n    auth: {\n        autoRefreshToken: false,\n        persistSession: false\n    }\n}) : null;\n// Fetch crowd density data\nasync function fetchCrowdDensity() {\n    const { data, error } = await supabase.from(\"crowd_density\").select(\"*\").order(\"updated_at\", {\n        ascending: false\n    });\n    if (error) {\n        console.error(\"Error fetching crowd density:\", error);\n        return [];\n    }\n    return data;\n}\n// Subscribe to crowd density updates\nfunction subscribeToCrowdDensity(callback) {\n    const subscription = supabase.channel(\"crowd_density_updates\").on(\"postgres_changes\", {\n        event: \"*\",\n        schema: \"public\",\n        table: \"crowd_density\"\n    }, (payload)=>{\n        fetchCrowdDensity().then(callback);\n    }).subscribe();\n    return ()=>{\n        supabase.removeChannel(subscription);\n    };\n}\n// Fetch safety alerts\nasync function fetchSafetyAlerts() {\n    const { data, error } = await supabase.from(\"safety_alerts\").select(\"*\").gt(\"expires_at\", new Date().toISOString()).order(\"severity\", {\n        ascending: false\n    });\n    if (error) {\n        console.error(\"Error fetching safety alerts:\", error);\n        return [];\n    }\n    return data;\n}\n// For demo purposes, mock route calculation\nasync function getOptimalRoute(start, destination) {\n    // In a real app, this would call a serverless function or external API\n    // For the prototype, we'll return mock data\n    return {\n        distance: \"2.3 km\",\n        duration: \"30 minutes\",\n        congestion_level: \"medium\",\n        waypoints: []\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL3N1cGFiYXNlLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7QUFBcUQ7QUFFckQsd0JBQXdCO0FBQ3hCLE1BQU1DLGNBQWNDLDJDQUFvQyxJQUFJO0FBQzVELE1BQU1HLGtCQUFrQkgsa05BQXlDLElBQUk7QUFDckUsTUFBTUsscUJBQXFCTCxRQUFRQyxHQUFHLENBQUNLLHlCQUF5QixJQUFJO0FBRXBFLG9EQUFvRDtBQUNwRCw2QkFBNkI7QUFDdEIsTUFBTUMsV0FBV1QsbUVBQVlBLENBQUNDLGFBQWFJLGlCQUFpQjtBQUVuRSxnR0FBZ0c7QUFDaEcsNkNBQTZDO0FBQ3RDLE1BQU1LLGdCQUFnQkgsc0JBQXNCQSxtQkFBbUJJLE1BQU0sR0FBRyxJQUMzRVgsbUVBQVlBLENBQUNDLGFBQWFNLG9CQUFvQjtJQUM1Q0ssTUFBTTtRQUNKQyxrQkFBa0I7UUFDbEJDLGdCQUFnQjtJQUNsQjtBQUNGLEtBQ0EsS0FBSztBQW9DVCwyQkFBMkI7QUFDcEIsZUFBZUM7SUFDcEIsTUFBTSxFQUFFQyxJQUFJLEVBQUVDLEtBQUssRUFBRSxHQUFHLE1BQU1SLFNBQzNCUyxJQUFJLENBQUMsaUJBQ0xDLE1BQU0sQ0FBQyxLQUNQQyxLQUFLLENBQUMsY0FBYztRQUFFQyxXQUFXO0lBQU07SUFFMUMsSUFBSUosT0FBTztRQUNUSyxRQUFRTCxLQUFLLENBQUMsaUNBQWlDQTtRQUMvQyxPQUFPLEVBQUU7SUFDWDtJQUNBLE9BQU9EO0FBQ1Q7QUFFQSxxQ0FBcUM7QUFDOUIsU0FBU08sd0JBQXdCQyxRQUF3QztJQUM5RSxNQUFNQyxlQUFlaEIsU0FDbEJpQixPQUFPLENBQUMseUJBQ1JDLEVBQUUsQ0FDRCxvQkFDQTtRQUFFQyxPQUFPO1FBQUtDLFFBQVE7UUFBVUMsT0FBTztJQUFnQixHQUN2RCxDQUFDQztRQUNDaEIsb0JBQW9CaUIsSUFBSSxDQUFDUjtJQUMzQixHQUVEUyxTQUFTO0lBRVosT0FBTztRQUNMeEIsU0FBU3lCLGFBQWEsQ0FBQ1Q7SUFDekI7QUFDRjtBQUVBLHNCQUFzQjtBQUNmLGVBQWVVO0lBQ3BCLE1BQU0sRUFBRW5CLElBQUksRUFBRUMsS0FBSyxFQUFFLEdBQUcsTUFBTVIsU0FDM0JTLElBQUksQ0FBQyxpQkFDTEMsTUFBTSxDQUFDLEtBQ1BpQixFQUFFLENBQUMsY0FBYyxJQUFJQyxPQUFPQyxXQUFXLElBQ3ZDbEIsS0FBSyxDQUFDLFlBQVk7UUFBRUMsV0FBVztJQUFNO0lBRXhDLElBQUlKLE9BQU87UUFDVEssUUFBUUwsS0FBSyxDQUFDLGlDQUFpQ0E7UUFDL0MsT0FBTyxFQUFFO0lBQ1g7SUFDQSxPQUFPRDtBQUNUO0FBRUEsNENBQTRDO0FBQ3JDLGVBQWV1QixnQkFBZ0JDLEtBQWEsRUFBRUMsV0FBbUI7SUFDdEUsdUVBQXVFO0lBQ3ZFLDRDQUE0QztJQUM1QyxPQUFPO1FBQ0xDLFVBQVU7UUFDVkMsVUFBVTtRQUNWQyxrQkFBa0I7UUFDbEJDLFdBQVcsRUFFVjtJQUNIO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9oYWpqLW5hdmlnYXRvci8uL3NyYy9saWIvc3VwYWJhc2UudHM/MDZlMSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBjcmVhdGVDbGllbnQgfSBmcm9tICdAc3VwYWJhc2Uvc3VwYWJhc2UtanMnO1xyXG5cclxuLy8gRW52aXJvbm1lbnQgdmFyaWFibGVzXHJcbmNvbnN0IHN1cGFiYXNlVXJsID0gcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfU1VQQUJBU0VfVVJMIHx8ICdodHRwczovL2V4YW1wbGUuc3VwYWJhc2UuY28nO1xyXG5jb25zdCBzdXBhYmFzZUFub25LZXkgPSBwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19TVVBBQkFTRV9BTk9OX0tFWSB8fCAnZXlKaGJHY2lPaUpJVXpJMU5pSXNJblI1Y0NJNklrcFhWQ0o5LmV5SnBjM01pT2lKemRYQmhZbUZ6WlNJc0luSmxaaUk2SW5WdmQydHRjM1owY1hKemVXSnNiMkp6WVhwM0lpd2ljbTlzWlNJNkltRnViMjRpTENKcFlYUWlPakUzTkRVME16YzJOVGdzSW1WNGNDSTZNakEyTVRBeE16WTFPSDAuRUJRM1BuOXl2TjJMNkc1SFRlNWMxMGJHT0Y4eHMyOGpRLXBsRTFnOEhPYyc7XHJcbmNvbnN0IHN1cGFiYXNlU2VydmljZUtleSA9IHByb2Nlc3MuZW52LlNVUEFCQVNFX1NFUlZJQ0VfUk9MRV9LRVkgfHwgJyc7XHJcblxyXG4vLyBDbGllbnQgZm9yIGNsaWVudC1zaWRlIGFuZCBhdXRoZW50aWNhdGVkIHJlcXVlc3RzXHJcbi8vIEVuc3VyZSB3ZSBoYXZlIGEgdmFsaWQga2V5XHJcbmV4cG9ydCBjb25zdCBzdXBhYmFzZSA9IGNyZWF0ZUNsaWVudChzdXBhYmFzZVVybCwgc3VwYWJhc2VBbm9uS2V5KTtcclxuXHJcbi8vIFNlcnZpY2Ugcm9sZSBjbGllbnQgZm9yIHNlcnZlci1zaWRlIG9wZXJhdGlvbnMgKG9ubHkgdXNlZCBpbiBzZXJ2ZXIgY29tcG9uZW50cyBvciBBUEkgcm91dGVzKVxyXG4vLyBPbmx5IGNyZWF0ZSBpZiB3ZSBoYXZlIGEgdmFsaWQgc2VydmljZSBrZXlcclxuZXhwb3J0IGNvbnN0IHN1cGFiYXNlQWRtaW4gPSBzdXBhYmFzZVNlcnZpY2VLZXkgJiYgc3VwYWJhc2VTZXJ2aWNlS2V5Lmxlbmd0aCA+IDBcclxuICA/IGNyZWF0ZUNsaWVudChzdXBhYmFzZVVybCwgc3VwYWJhc2VTZXJ2aWNlS2V5LCB7XHJcbiAgICAgIGF1dGg6IHtcclxuICAgICAgICBhdXRvUmVmcmVzaFRva2VuOiBmYWxzZSxcclxuICAgICAgICBwZXJzaXN0U2Vzc2lvbjogZmFsc2VcclxuICAgICAgfVxyXG4gICAgfSlcclxuICA6IG51bGw7XHJcblxyXG4vLyBUeXBlcyBmb3Igb3VyIGRhdGFiYXNlXHJcbmV4cG9ydCB0eXBlIENyb3dkRGVuc2l0eSA9IHtcclxuICBpZDogbnVtYmVyO1xyXG4gIGxvY2F0aW9uX25hbWU6IHN0cmluZztcclxuICBjb29yZGluYXRlczogeyBsbmc6IG51bWJlcjsgbGF0OiBudW1iZXIgfTtcclxuICBkZW5zaXR5X2xldmVsOiAnbG93JyB8ICdtZWRpdW0nIHwgJ2hpZ2gnIHwgJ2NyaXRpY2FsJztcclxuICB1cGRhdGVkX2F0OiBzdHJpbmc7XHJcbiAgLy8gTmV3IGZpZWxkcyBmb3IgcmVhbGlzdGljIGNyb3dkIGRlbnNpdHlcclxuICBjcm93ZF9zaXplPzogbnVtYmVyO1xyXG4gIG9jY3VwYW5jeV9wZXJjZW50YWdlPzogc3RyaW5nO1xyXG4gIG1ldGFfZGF0YT86IHtcclxuICAgIGRlbnNpdHk6IHN0cmluZztcclxuICAgIGNhcGFjaXR5OiBudW1iZXI7XHJcbiAgICBzZWN0aW9uczogQXJyYXk8e1xyXG4gICAgICBpZDogc3RyaW5nO1xyXG4gICAgICBuYW1lOiBzdHJpbmc7XHJcbiAgICAgIGRlbnNpdHk6IHN0cmluZztcclxuICAgICAgZGVuc2l0eV9sZXZlbDogJ2xvdycgfCAnbWVkaXVtJyB8ICdoaWdoJyB8ICdjcml0aWNhbCc7XHJcbiAgICAgIGNyb3dkX3NpemU6IG51bWJlcjtcclxuICAgIH0+O1xyXG4gIH07XHJcbn07XHJcblxyXG5leHBvcnQgdHlwZSBTYWZldHlBbGVydCA9IHtcclxuICBpZDogbnVtYmVyO1xyXG4gIHRpdGxlOiBzdHJpbmc7XHJcbiAgZGVzY3JpcHRpb246IHN0cmluZztcclxuICBsb2NhdGlvbl9uYW1lOiBzdHJpbmc7XHJcbiAgY29vcmRpbmF0ZXM6IHsgbG5nOiBudW1iZXI7IGxhdDogbnVtYmVyIH07XHJcbiAgc2V2ZXJpdHk6ICdpbmZvJyB8ICd3YXJuaW5nJyB8ICdkYW5nZXInO1xyXG4gIGNyZWF0ZWRfYXQ6IHN0cmluZztcclxuICBleHBpcmVzX2F0OiBzdHJpbmc7XHJcbn07XHJcblxyXG4vLyBGZXRjaCBjcm93ZCBkZW5zaXR5IGRhdGFcclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGZldGNoQ3Jvd2REZW5zaXR5KCkge1xyXG4gIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXHJcbiAgICAuZnJvbSgnY3Jvd2RfZGVuc2l0eScpXHJcbiAgICAuc2VsZWN0KCcqJylcclxuICAgIC5vcmRlcigndXBkYXRlZF9hdCcsIHsgYXNjZW5kaW5nOiBmYWxzZSB9KTtcclxuXHJcbiAgaWYgKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBmZXRjaGluZyBjcm93ZCBkZW5zaXR5OicsIGVycm9yKTtcclxuICAgIHJldHVybiBbXTtcclxuICB9XHJcbiAgcmV0dXJuIGRhdGEgYXMgQ3Jvd2REZW5zaXR5W107XHJcbn1cclxuXHJcbi8vIFN1YnNjcmliZSB0byBjcm93ZCBkZW5zaXR5IHVwZGF0ZXNcclxuZXhwb3J0IGZ1bmN0aW9uIHN1YnNjcmliZVRvQ3Jvd2REZW5zaXR5KGNhbGxiYWNrOiAoZGF0YTogQ3Jvd2REZW5zaXR5W10pID0+IHZvaWQpIHtcclxuICBjb25zdCBzdWJzY3JpcHRpb24gPSBzdXBhYmFzZVxyXG4gICAgLmNoYW5uZWwoJ2Nyb3dkX2RlbnNpdHlfdXBkYXRlcycpXHJcbiAgICAub24oXHJcbiAgICAgICdwb3N0Z3Jlc19jaGFuZ2VzJyxcclxuICAgICAgeyBldmVudDogJyonLCBzY2hlbWE6ICdwdWJsaWMnLCB0YWJsZTogJ2Nyb3dkX2RlbnNpdHknIH0sXHJcbiAgICAgIChwYXlsb2FkKSA9PiB7XHJcbiAgICAgICAgZmV0Y2hDcm93ZERlbnNpdHkoKS50aGVuKGNhbGxiYWNrKTtcclxuICAgICAgfVxyXG4gICAgKVxyXG4gICAgLnN1YnNjcmliZSgpO1xyXG5cclxuICByZXR1cm4gKCkgPT4ge1xyXG4gICAgc3VwYWJhc2UucmVtb3ZlQ2hhbm5lbChzdWJzY3JpcHRpb24pO1xyXG4gIH07XHJcbn1cclxuXHJcbi8vIEZldGNoIHNhZmV0eSBhbGVydHNcclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGZldGNoU2FmZXR5QWxlcnRzKCkge1xyXG4gIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXHJcbiAgICAuZnJvbSgnc2FmZXR5X2FsZXJ0cycpXHJcbiAgICAuc2VsZWN0KCcqJylcclxuICAgIC5ndCgnZXhwaXJlc19hdCcsIG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSlcclxuICAgIC5vcmRlcignc2V2ZXJpdHknLCB7IGFzY2VuZGluZzogZmFsc2UgfSk7XHJcblxyXG4gIGlmIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgc2FmZXR5IGFsZXJ0czonLCBlcnJvcik7XHJcbiAgICByZXR1cm4gW107XHJcbiAgfVxyXG4gIHJldHVybiBkYXRhIGFzIFNhZmV0eUFsZXJ0W107XHJcbn1cclxuXHJcbi8vIEZvciBkZW1vIHB1cnBvc2VzLCBtb2NrIHJvdXRlIGNhbGN1bGF0aW9uXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRPcHRpbWFsUm91dGUoc3RhcnQ6IHN0cmluZywgZGVzdGluYXRpb246IHN0cmluZykge1xyXG4gIC8vIEluIGEgcmVhbCBhcHAsIHRoaXMgd291bGQgY2FsbCBhIHNlcnZlcmxlc3MgZnVuY3Rpb24gb3IgZXh0ZXJuYWwgQVBJXHJcbiAgLy8gRm9yIHRoZSBwcm90b3R5cGUsIHdlJ2xsIHJldHVybiBtb2NrIGRhdGFcclxuICByZXR1cm4ge1xyXG4gICAgZGlzdGFuY2U6ICcyLjMga20nLFxyXG4gICAgZHVyYXRpb246ICczMCBtaW51dGVzJyxcclxuICAgIGNvbmdlc3Rpb25fbGV2ZWw6ICdtZWRpdW0nLFxyXG4gICAgd2F5cG9pbnRzOiBbXHJcbiAgICAgIC8vIFNpbXBsaWZpZWQgcm91dGUgY29vcmRpbmF0ZXMgd291bGQgZ28gaGVyZVxyXG4gICAgXVxyXG4gIH07XHJcbn0gIl0sIm5hbWVzIjpbImNyZWF0ZUNsaWVudCIsInN1cGFiYXNlVXJsIiwicHJvY2VzcyIsImVudiIsIk5FWFRfUFVCTElDX1NVUEFCQVNFX1VSTCIsInN1cGFiYXNlQW5vbktleSIsIk5FWFRfUFVCTElDX1NVUEFCQVNFX0FOT05fS0VZIiwic3VwYWJhc2VTZXJ2aWNlS2V5IiwiU1VQQUJBU0VfU0VSVklDRV9ST0xFX0tFWSIsInN1cGFiYXNlIiwic3VwYWJhc2VBZG1pbiIsImxlbmd0aCIsImF1dGgiLCJhdXRvUmVmcmVzaFRva2VuIiwicGVyc2lzdFNlc3Npb24iLCJmZXRjaENyb3dkRGVuc2l0eSIsImRhdGEiLCJlcnJvciIsImZyb20iLCJzZWxlY3QiLCJvcmRlciIsImFzY2VuZGluZyIsImNvbnNvbGUiLCJzdWJzY3JpYmVUb0Nyb3dkRGVuc2l0eSIsImNhbGxiYWNrIiwic3Vic2NyaXB0aW9uIiwiY2hhbm5lbCIsIm9uIiwiZXZlbnQiLCJzY2hlbWEiLCJ0YWJsZSIsInBheWxvYWQiLCJ0aGVuIiwic3Vic2NyaWJlIiwicmVtb3ZlQ2hhbm5lbCIsImZldGNoU2FmZXR5QWxlcnRzIiwiZ3QiLCJEYXRlIiwidG9JU09TdHJpbmciLCJnZXRPcHRpbWFsUm91dGUiLCJzdGFydCIsImRlc3RpbmF0aW9uIiwiZGlzdGFuY2UiLCJkdXJhdGlvbiIsImNvbmdlc3Rpb25fbGV2ZWwiLCJ3YXlwb2ludHMiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/supabase.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/@supabase","vendor-chunks/whatwg-url","vendor-chunks/tr46","vendor-chunks/webidl-conversions"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fcrowd-density%2Froute&page=%2Fapi%2Fcrowd-density%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fcrowd-density%2Froute.ts&appDir=C%3A%5CUsers%5Cyouse%5COneDrive%5CDesktop%5CKAU%5CFourth_Year_IT%5CTerm2%5CCPIT-455%5CFinal-Project%5Ctafweej_Hajj%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5Cyouse%5COneDrive%5CDesktop%5CKAU%5CFourth_Year_IT%5CTerm2%5CCPIT-455%5CFinal-Project%5Ctafweej_Hajj&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();
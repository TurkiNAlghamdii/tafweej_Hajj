"use strict";(()=>{var e={};e.id=90,e.ids=[90],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},8893:e=>{e.exports=require("buffer")},4770:e=>{e.exports=require("crypto")},7702:e=>{e.exports=require("events")},2615:e=>{e.exports=require("http")},8791:e=>{e.exports=require("https")},8216:e=>{e.exports=require("net")},8621:e=>{e.exports=require("punycode")},6162:e=>{e.exports=require("stream")},2452:e=>{e.exports=require("tls")},7360:e=>{e.exports=require("url")},1568:e=>{e.exports=require("zlib")},9909:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>g,patchFetch:()=>R,requestAsyncStorage:()=>f,routeModule:()=>d,serverHooks:()=>y,staticGenerationAsyncStorage:()=>x});var s={};t.r(s),t.d(s,{DELETE:()=>l,GET:()=>u,POST:()=>c});var o=t(9303),n=t(8716),i=t(670),a=t(7070),p=t(1926);async function u(){if(!p.pR)return a.NextResponse.json({error:"Service role key not configured"},{status:500});try{let{data:e,error:r}=await p.pR.from("safety_alerts").select("*").gt("expires_at",new Date().toISOString()).order("severity",{ascending:!1});if(r)throw r;return a.NextResponse.json(e)}catch(e){return console.error("Error fetching safety alerts:",e),a.NextResponse.json({error:"Error fetching safety alert data"},{status:500})}}async function c(e){if(!p.pR)return a.NextResponse.json({error:"Service role key not configured"},{status:500});try{let r=await e.json();if(!r.title||!r.description||!r.location_name||!r.coordinates||!r.severity||!r.expires_at)return a.NextResponse.json({error:"Missing required fields"},{status:400});let{data:t,error:s}=await p.pR.from("safety_alerts").insert({title:r.title,description:r.description,location_name:r.location_name,coordinates:r.coordinates,severity:r.severity,created_at:new Date().toISOString(),expires_at:r.expires_at}).select();if(s)throw s;return a.NextResponse.json(t)}catch(e){return console.error("Error creating safety alert:",e),a.NextResponse.json({error:"Error creating safety alert"},{status:500})}}async function l(e){if(!p.pR)return a.NextResponse.json({error:"Service role key not configured"},{status:500});try{let{searchParams:r}=new URL(e.url),t=r.get("id");if(!t)return a.NextResponse.json({error:"Missing alert ID"},{status:400});let{error:s}=await p.pR.from("safety_alerts").delete().eq("id",t);if(s)throw s;return a.NextResponse.json({success:!0})}catch(e){return console.error("Error deleting safety alert:",e),a.NextResponse.json({error:"Error deleting safety alert"},{status:500})}}let d=new o.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/safety-alerts/route",pathname:"/api/safety-alerts",filename:"route",bundlePath:"app/api/safety-alerts/route"},resolvedPagePath:"C:\\Users\\kiing\\Documents\\GitHub\\tafweej_Hajj\\src\\app\\api\\safety-alerts\\route.ts",nextConfigOutput:"export",userland:s}),{requestAsyncStorage:f,staticGenerationAsyncStorage:x,serverHooks:y}=d,g="/api/safety-alerts/route";function R(){return(0,i.patchFetch)({serverHooks:y,staticGenerationAsyncStorage:x})}},1926:(e,r,t)=>{t.d(r,{pR:()=>i});var s=t(1518);let o="https://uowkmsvtqrsyblobsazw.supabase.co",n=process.env.SUPABASE_SERVICE_ROLE_KEY,i=((0,s.eI)(o,"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InVvd2ttc3Z0cXJzeWJsb2JzYXp3Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDU0Mzc2NTgsImV4cCI6MjA2MTAxMzY1OH0.EBQ3Pn9yvN2L6G5HTe5c10bGOF8xs28jQ-plE1g8HOc"),n?(0,s.eI)(o,n,{auth:{autoRefreshToken:!1,persistSession:!1}}):null)}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[276,135],()=>t(9909));module.exports=s})();
(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[316],{9055:function(e,s,t){Promise.resolve().then(t.bind(t,4919))},4919:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return i}});var r=t(7437),a=t(2265),l=t(3768);let n=["Masjid al-Haram","Mina","Arafat","Muzdalifah","Jamaraat Bridge"];function i(){let[e,s]=(0,a.useState)(""),[t,i]=(0,a.useState)(""),[d,o]=(0,a.useState)(!1),[c,m]=(0,a.useState)(null),[x,u]=(0,a.useState)(""),[h,g]=(0,a.useState)([]),[b,p]=(0,a.useState)(!1),[f,j]=(0,a.useState)(null),v=async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];p(!0);try{let s=await fetch(e?"/api/crowd-density?force=true":"/api/crowd-density");if(!s.ok)throw Error("Failed to fetch crowd density data");let t=await s.json();g(t),j(new Date)}catch(e){console.error("Error fetching crowd density:",e)}finally{p(!1)}};(0,a.useEffect)(()=>{v()},[]);let w=async s=>{if(s.preventDefault(),!e||!t){u("Please select both start and destination locations");return}if(e===t){u("Start and destination cannot be the same");return}o(!0),u("");try{let s=await fetch("/api/routes?start=".concat(encodeURIComponent(e),"&destination=").concat(encodeURIComponent(t)));if(!s.ok){let e=await s.json();throw Error(e.error||"Failed to calculate route")}let r=await s.json();m(r)}catch(e){u(e.message||"Failed to calculate route. Please try again."),console.error(e)}finally{o(!1)}},N=e=>{switch(e){case"low":return"bg-green-500";case"medium":return"bg-yellow-500";case"high":return"bg-orange-500";case"critical":return"bg-red-500";default:return"bg-gray-500"}},y=e=>{switch(e){case"low":return"text-green-600";case"medium":return"text-yellow-600";case"high":return"text-orange-600";case"critical":return"text-red-600";default:return"text-gray-600"}},k=e=>{var s;return(null===(s=h.find(s=>s.location_name===e))||void 0===s?void 0:s.density_level)||"unknown"};return(0,r.jsxs)("div",{className:"min-h-screen flex flex-col",children:[(0,r.jsx)(l.Z,{}),(0,r.jsx)("main",{className:"flex-grow bg-gray-50",children:(0,r.jsxs)("div",{className:"max-w-4xl mx-auto p-4",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold mb-2",children:"Personalized Route Suggestions"}),(0,r.jsx)("p",{className:"text-gray-600 mb-6",children:"Find optimal routes using real-time crowd density data"}),(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-4 mb-6",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-3",children:[(0,r.jsx)("h2",{className:"text-md font-semibold",children:"Current Crowd Density"}),(0,r.jsxs)("div",{className:"flex items-center text-sm text-gray-500",children:[f&&(0,r.jsxs)("span",{className:"mr-2",children:["Last updated: ",f.toLocaleTimeString()]}),(0,r.jsxs)("button",{onClick:e=>{e.preventDefault(),v(!0)},disabled:b,className:"text-blue-600 hover:text-blue-800 flex items-center disabled:opacity-50",children:[(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),b?"Refreshing...":"Refresh"]})]})]}),b&&0===h.length?(0,r.jsx)("div",{className:"flex justify-center items-center h-10",children:(0,r.jsx)("div",{className:"animate-pulse text-gray-500",children:"Loading crowd data..."})}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-2",children:n.map(e=>{let s=k(e);return(0,r.jsxs)("div",{className:"flex flex-col items-center bg-gray-50 rounded p-2",children:[(0,r.jsx)("div",{className:"text-sm font-medium truncate w-full text-center",children:e}),(0,r.jsxs)("div",{className:"mt-1 px-2 py-1 rounded-full text-xs font-medium ".concat(y(s)),children:[(0,r.jsx)("span",{className:"inline-block w-3 h-3 rounded-full mr-1 ".concat(N(s))}),s.charAt(0).toUpperCase()+s.slice(1)]})]},e)})}),(0,r.jsxs)("div",{className:"flex justify-between mt-3 text-xs text-gray-500",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("span",{className:"inline-block w-2 h-2 rounded-full bg-green-500 mr-1"}),(0,r.jsx)("span",{children:"Low"})]}),(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("span",{className:"inline-block w-2 h-2 rounded-full bg-yellow-500 mr-1"}),(0,r.jsx)("span",{children:"Medium"})]}),(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("span",{className:"inline-block w-2 h-2 rounded-full bg-orange-500 mr-1"}),(0,r.jsx)("span",{children:"High"})]}),(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("span",{className:"inline-block w-2 h-2 rounded-full bg-red-500 mr-1"}),(0,r.jsx)("span",{children:"Critical"})]})]})]})]}),(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-4 mb-6",children:[(0,r.jsx)("h2",{className:"text-lg font-semibold mb-4",children:"Find the best route"}),0===h.length?(0,r.jsx)("div",{className:"bg-yellow-50 border border-yellow-200 text-yellow-800 p-4 rounded-lg mb-4",children:(0,r.jsxs)("div",{className:"flex items-start",children:[(0,r.jsx)("svg",{className:"h-5 w-5 text-yellow-600 mt-0.5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"font-medium",children:"Waiting for crowd density data"}),(0,r.jsx)("p",{className:"text-sm mt-1",children:"Route planning requires crowd density information"})]})]})}):(0,r.jsxs)("form",{onSubmit:w,children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"start",className:"block text-sm font-medium text-gray-700 mb-1",children:"Your Current Location"}),(0,r.jsxs)("select",{id:"start",value:e,onChange:e=>s(e.target.value),className:"w-full rounded-md border-gray-300 shadow-sm py-2 px-3 bg-white border focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,r.jsx)("option",{value:"",children:"Select location"}),n.map(e=>{let s=k(e);return(0,r.jsxs)("option",{value:e,children:[e," ","unknown"!==s?"(".concat(s,")"):""]},"start-".concat(e))})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"destination",className:"block text-sm font-medium text-gray-700 mb-1",children:"Your Destination"}),(0,r.jsxs)("select",{id:"destination",value:t,onChange:e=>i(e.target.value),className:"w-full rounded-md border-gray-300 shadow-sm py-2 px-3 bg-white border focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,r.jsx)("option",{value:"",children:"Select destination"}),n.map(e=>{let s=k(e);return(0,r.jsxs)("option",{value:e,children:[e," ","unknown"!==s?"(".concat(s,")"):""]},"end-".concat(e))})]})]})]}),x&&(0,r.jsx)("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded mb-4",children:x}),(0,r.jsx)("div",{className:"bg-blue-50 border border-blue-200 text-blue-800 p-3 rounded mb-4 text-sm",children:(0,r.jsx)("p",{children:"Routes are based on current crowd density levels. Less crowded routes will be faster."})}),(0,r.jsx)("button",{type:"submit",disabled:d,className:"w-full bg-blue-600 text-white font-medium py-2 px-4 rounded hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:opacity-50",children:d?"Calculating...":"Find Best Route"})]})]}),c&&(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-4",children:[(0,r.jsx)("h2",{className:"text-lg font-semibold mb-4",children:"Recommended Route"}),(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsxs)("div",{className:"flex items-center mb-4",children:[(0,r.jsx)("div",{className:"w-10 h-10 rounded-full bg-blue-100 flex items-center justify-center text-blue-600 mr-3",children:(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]})}),(0,r.jsxs)("div",{className:"flex-grow",children:[(0,r.jsx)("div",{className:"text-sm text-gray-500",children:"From"}),(0,r.jsxs)("div",{className:"font-semibold flex items-center",children:[c.start,(0,r.jsx)("span",{className:"ml-2 inline-block w-3 h-3 rounded-full ".concat(N(k(c.start)))})]})]})]}),(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:"w-10 h-10 rounded-full bg-green-100 flex items-center justify-center text-green-600 mr-3",children:(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]})}),(0,r.jsxs)("div",{className:"flex-grow",children:[(0,r.jsx)("div",{className:"text-sm text-gray-500",children:"To"}),(0,r.jsxs)("div",{className:"font-semibold flex items-center",children:[c.destination,(0,r.jsx)("span",{className:"ml-2 inline-block w-3 h-3 rounded-full ".concat(N(k(c.destination)))})]})]})]})]}),(0,r.jsxs)("div",{className:"flex items-center mb-4 bg-blue-50 border border-blue-100 rounded-lg px-3 py-2",children:[(0,r.jsx)("svg",{className:"w-5 h-5 text-blue-500 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,r.jsx)("span",{className:"text-sm text-blue-800",children:"Route calculated using real-time crowd density data"})]}),(0,r.jsxs)("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[(0,r.jsxs)("div",{className:"bg-gray-50 p-3 rounded-lg",children:[(0,r.jsx)("div",{className:"text-sm text-gray-500 mb-1",children:"Distance"}),(0,r.jsx)("div",{className:"font-semibold",children:c.distance})]}),(0,r.jsxs)("div",{className:"bg-gray-50 p-3 rounded-lg",children:[(0,r.jsx)("div",{className:"text-sm text-gray-500 mb-1",children:"Duration"}),(0,r.jsx)("div",{className:"font-semibold",children:c.duration})]}),(0,r.jsxs)("div",{className:"p-3 rounded-lg ".concat("low"===c.congestion_level?"bg-green-50":"medium"===c.congestion_level?"bg-yellow-50":"high"===c.congestion_level?"bg-orange-50":"bg-red-50"),children:[(0,r.jsx)("div",{className:"text-sm text-gray-500 mb-1",children:"Congestion"}),(0,r.jsxs)("div",{className:"font-semibold flex items-center ".concat(y(c.congestion_level)),children:[(0,r.jsx)("span",{className:"inline-block w-3 h-3 rounded-full mr-1 ".concat(N(c.congestion_level))}),c.congestion_level.charAt(0).toUpperCase()+c.congestion_level.slice(1)]})]})]}),(0,r.jsxs)("div",{className:"border border-gray-100 p-4 rounded-lg mb-3",children:[(0,r.jsx)("h3",{className:"font-medium mb-3",children:"Route Directions"}),(0,r.jsx)("ol",{className:"space-y-3 pl-4",children:c.directions.map((e,s)=>{let t=e.includes("Warning");return(0,r.jsx)("li",{className:"".concat(t?"text-red-600 font-medium":""),children:e},s)})})]}),"high"===c.congestion_level||"critical"===c.congestion_level?(0,r.jsx)("div",{className:"bg-yellow-50 border border-yellow-200 text-yellow-800 p-4 rounded-lg",children:(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-yellow-600 mr-2",viewBox:"0 0 20 20",fill:"currentColor",children:(0,r.jsx)("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"font-medium",children:"High congestion detected on this route"}),(0,r.jsx)("p",{className:"text-sm",children:"Consider alternative timing or route if possible"})]})]})}):null]})]})})]})}},3768:function(e,s,t){"use strict";t.d(s,{Z:function(){return d}});var r=t(7437),a=t(2265),l=t(7648),n=t(9376),i=t(5922);function d(){let e=(0,n.usePathname)(),{theme:s,setTheme:t}=(0,i.F)(),[d,o]=(0,a.useState)(!1);return(0,a.useEffect)(()=>{o(!0)},[]),(0,r.jsx)("header",{className:"bg-white dark:bg-gray-800 border-b border-slate-200 dark:border-gray-700 backdrop-blur-sm",children:(0,r.jsxs)("div",{className:"max-w-7xl mx-auto px-4 py-3 sm:px-6 flex justify-between items-center",children:[(0,r.jsxs)(l.default,{href:"/",className:"text-xl font-bold text-slate-800 dark:text-slate-200 flex items-center",children:[(0,r.jsx)("span",{className:"mr-2 text-primary dark:text-primary-dark",children:"\uD83D\uDD4B"}),(0,r.jsx)("span",{className:"bg-gradient-to-r from-primary to-primary/80 bg-clip-text text-transparent dark:from-primary-dark dark:to-primary-dark/80",children:"Tafweej Hajj"})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsxs)("div",{className:"hidden md:flex space-x-1",children:[(0,r.jsx)(l.default,{href:"/map",className:"px-4 py-2 rounded-md transition-all duration-200 ".concat("/map"===e?"bg-primary/10 text-primary dark:bg-primary-dark/20 dark:text-primary-dark font-medium":"text-slate-600 hover:bg-slate-100 dark:text-slate-300 dark:hover:bg-gray-700"),children:"Map"}),(0,r.jsx)(l.default,{href:"/routes",className:"px-4 py-2 rounded-md transition-all duration-200 ".concat("/routes"===e?"bg-primary/10 text-primary dark:bg-primary-dark/20 dark:text-primary-dark font-medium":"text-slate-600 hover:bg-slate-100 dark:text-slate-300 dark:hover:bg-gray-700"),children:"Routes"}),(0,r.jsx)(l.default,{href:"/alerts",className:"px-4 py-2 rounded-md transition-all duration-200 ".concat("/alerts"===e?"bg-primary/10 text-primary dark:bg-primary-dark/20 dark:text-primary-dark font-medium":"text-slate-600 hover:bg-slate-100 dark:text-slate-300 dark:hover:bg-gray-700"),children:"Alerts"})]}),(0,r.jsx)("button",{"aria-label":"Toggle Dark Mode",type:"button",className:"w-10 h-10 p-2 rounded-full bg-slate-100 dark:bg-gray-700 flex items-center justify-center transition-all duration-300 hover:bg-slate-200 dark:hover:bg-gray-600 shadow-sm",onClick:()=>t("dark"===s?"light":"dark"),children:d&&(0,r.jsx)(r.Fragment,{children:"dark"===s?(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-yellow-400",viewBox:"0 0 20 20",fill:"currentColor",children:(0,r.jsx)("path",{fillRule:"evenodd",d:"M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707a1 1 0 00-1.414 1.414l.707.707zm1.414 8.486l-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z",clipRule:"evenodd"})}):(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-slate-700",viewBox:"0 0 20 20",fill:"currentColor",children:(0,r.jsx)("path",{d:"M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"})})})}),(0,r.jsx)("button",{className:"md:hidden rounded-md p-2 text-slate-600 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-gray-700",onClick:()=>{alert("Mobile menu would open here. Not implemented in this prototype.")},children:(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})})]})]})})}}},function(e){e.O(0,[733,971,117,744],function(){return e(e.s=9055)}),_N_E=e.O()}]);